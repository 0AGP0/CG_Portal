"use strict";(()=>{var e={};e.id=2588,e.ids=[2588],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41423:(e,r,t)=>{t.d(r,{HU:()=>u,nr:()=>l});var a=t(43205),o=t.n(a);t(85663),t(32190),t(55511);let s=process.env.JWT_SECRET||"your-secret-key",n=process.env.JWT_EXPIRES_IN||"24h",i=new Map,u=e=>o().sign(e,s,{expiresIn:n}),l=e=>{try{return o().verify(e,s)}catch(e){return p("Token doğrulama hatası:",e),null}},p=(e,r)=>{let t=r?JSON.stringify(r,(e,r)=>"password"===e||"token"===e||"secret"===e?"***":r):void 0;console.log(`[${new Date().toISOString()}] ${e}`,t)}},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},53486:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{patchFetch:()=>l,routeModule:()=>p,serverHooks:()=>m,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>c});var o=t(96559),s=t(48088),n=t(37719),i=t(91576),u=e([i]);i=(u.then?(await u)():u)[0];let p=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/auth/verify/route",pathname:"/api/auth/verify",filename:"route",bundlePath:"app/api/auth/verify/route"},resolvedPagePath:"C:\\Users\\pc\\Downloads\\CG_Portal-main\\CG_Portal-main\\src\\app\\api\\auth\\verify\\route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:d,workUnitAsyncStorage:c,serverHooks:m}=p;function l(){return(0,n.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:c})}a()}catch(e){a(e)}})},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64939:e=>{e.exports=import("pg")},79428:e=>{e.exports=require("buffer")},91576:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{POST:()=>l});var o=t(32190),s=t(41423),n=t(86481),i=t(5069),u=e([i]);async function l(e){try{n.vF.info("Token doğrulama isteği alındı");let r=e.headers.get("Authorization");if(!r?.startsWith("Bearer "))return n.vF.error("Ge\xe7ersiz token formatı"),o.NextResponse.json({error:"Ge\xe7ersiz token formatı"},{status:401});let t=r.split(" ")[1],a=await e.json();if(!a.email||!a.role)return n.vF.error("Eksik kullanıcı bilgileri:",a),o.NextResponse.json({error:"Eksik kullanıcı bilgileri"},{status:400});n.vF.info("Token doğrulanıyor:",{email:a.email,role:a.role});let u=(0,s.nr)(t);if(!u)return n.vF.error("Token doğrulama hatası"),o.NextResponse.json({error:"Ge\xe7ersiz token"},{status:401});if(n.vF.info("Token başarıyla doğrulandı:",u),u.email!==a.email||u.role!==a.role)return n.vF.error("Token bilgileri eşleşmiyor:",{token:u,request:a}),o.NextResponse.json({error:"Token bilgileri eşleşmiyor"},{status:401});if("advisor"===a.role&&!await (0,i._Y)(a.email))return n.vF.error("Danışman bulunamadı:",a.email),o.NextResponse.json({error:"Danışman bulunamadı"},{status:401});return n.vF.info("Oturum doğrulandı:",a.email),o.NextResponse.json({success:!0,user:{id:u.id,email:u.email,role:u.role}})}catch(e){return n.vF.error("Token doğrulama hatası:",e),o.NextResponse.json({error:"Token doğrulama hatası"},{status:500})}}i=(u.then?(await u)():u)[0],a()}catch(e){a(e)}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[4447,580,5315,8033],()=>t(53486));module.exports=a})();