"use strict";(()=>{var e={};e.id=1151,e.ids=[1151],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},40776:(e,r,s)=>{s.a(e,async(e,t)=>{try{s.r(r),s.d(r,{patchFetch:()=>l,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>p});var a=s(96559),n=s(48088),i=s(37719),o=s(93761),u=e([o]);o=(u.then?(await u)():u)[0];let d=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/messages/send/route",pathname:"/api/messages/send",filename:"route",bundlePath:"app/api/messages/send/route"},resolvedPagePath:"C:\\Users\\pc\\Downloads\\CG_Portal-main\\CG_Portal-main\\src\\app\\api\\messages\\send\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:c,workUnitAsyncStorage:p,serverHooks:g}=d;function l(){return(0,i.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:p})}t()}catch(e){t(e)}})},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64939:e=>{e.exports=import("pg")},93761:(e,r,s)=>{s.a(e,async(e,t)=>{try{s.r(r),s.d(r,{POST:()=>u});var a=s(32190),n=s(5069),i=s(86481),o=e([n]);async function u(e){try{(0,i.fH)("Mesaj g\xf6nderme isteği alındı");let r=await e.json(),s=e.headers.get("x-user-email");if((0,i.fH)("Mesaj istenen parametreler:",{sender:s,receiver:r.receiverEmail,role:r.senderRole,subject:r.subject,hasContent:!!r.content}),!s)return(0,i.vV)("Kullanıcı kimliği eksik"),a.NextResponse.json({success:!1,error:"Kullanıcı kimliği gereklidir"},{status:401});if(!r.receiverEmail)return(0,i.vV)("Alıcı e-posta adresi eksik"),a.NextResponse.json({success:!1,error:"Alıcı e-posta adresi gereklidir"},{status:400});if(!r.content)return(0,i.vV)("Mesaj i\xe7eriği eksik"),a.NextResponse.json({success:!1,error:"Mesaj i\xe7eriği gereklidir"},{status:400});if(!r.senderRole||!["student","advisor"].includes(r.senderRole))return(0,i.vV)("Ge\xe7ersiz g\xf6nderen rol\xfc:",r.senderRole),a.NextResponse.json({success:!1,error:"G\xf6nderen rol\xfc ge\xe7erli değil"},{status:400});let t={senderEmail:s.toLowerCase(),receiverEmail:r.receiverEmail.toLowerCase(),senderRole:r.senderRole,content:r.content,subject:r.subject||null,category:r.category||"general",replyToId:r.replyToId||null},o=await (0,n.oH)(t);return(0,i.fH)("Mesaj başarıyla oluşturuldu:",o.id),a.NextResponse.json({success:!0,message:"Mesaj başarıyla g\xf6nderildi",data:{message:o}},{status:201})}catch(e){return(0,i.vV)("Mesaj g\xf6nderme hatası:",e),a.NextResponse.json({success:!1,error:"Mesaj g\xf6nderilirken bir hata oluştu"},{status:500})}}n=(o.then?(await o)():o)[0],t()}catch(e){t(e)}})}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4447,580,8033],()=>s(40776));module.exports=t})();