"use strict";(()=>{var e={};e.id=6501,e.ids=[6501],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41423:(e,r,t)=>{t.d(r,{HU:()=>u,nr:()=>l});var a=t(43205),s=t.n(a);t(85663),t(32190),t(55511);let i=process.env.JWT_SECRET||"your-secret-key",n=process.env.JWT_EXPIRES_IN||"24h",o=new Map,u=e=>s().sign(e,i,{expiresIn:n}),l=e=>{try{return s().verify(e,i)}catch(e){return d("Token doğrulama hatası:",e),null}},d=(e,r)=>{let t=r?JSON.stringify(r,(e,r)=>"password"===e||"token"===e||"secret"===e?"***":r):void 0;console.log(`[${new Date().toISOString()}] ${e}`,t)}},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64263:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{GET:()=>l});var s=t(32190),i=t(5069),n=t(86481),o=t(41423),u=e([i]);async function l(e,{params:r}){try{let{email:t}=await r,a=decodeURIComponent(t);n.vF.info("Danışman bilgisi isteği alındı:",a);let u=e.headers.get("authorization");if(!u?.startsWith("Bearer "))return n.vF.error("Ge\xe7ersiz token formatı"),s.NextResponse.json({error:"Ge\xe7ersiz token formatı"},{status:401});let l=u.split(" ")[1],d=(0,o.nr)(l);if(!d)return n.vF.error("Ge\xe7ersiz token"),s.NextResponse.json({error:"Ge\xe7ersiz token"},{status:401});let p=e.headers.get("x-user-email"),m=e.headers.get("x-user-role");if(!p||!m)return n.vF.error("Yetkilendirme başlıkları eksik:",{userEmail:p,userRole:m}),s.NextResponse.json({error:"Yetkilendirme gerekli"},{status:401});if(d.email!==p||d.role!==m)return n.vF.error("Token ve header bilgileri uyuşmuyor:",{token:d,headers:{userEmail:p,userRole:m}}),s.NextResponse.json({error:"Ge\xe7ersiz yetkilendirme bilgileri"},{status:401});if("advisor"!==m&&"admin"!==m)return n.vF.error("Ge\xe7ersiz kullanıcı rol\xfc:",m),s.NextResponse.json({error:"Bu işlem i\xe7in danışman yetkisi gerekli"},{status:403});let c=await (0,i._Y)(a);if(n.vF.info("Danışman arama sonucu:",c?{id:c.id,email:c.email,name:c.name}:"Danışman bulunamadı"),!c)return n.vF.error("Danışman bulunamadı:",a),s.NextResponse.json({error:"Danışman bulunamadı"},{status:404});if("admin"!==m&&p.toLowerCase()!==a.toLowerCase())return n.vF.error("Yetkisiz erişim denemesi:",{requestedEmail:a,userEmail:p,userRole:m}),s.NextResponse.json({error:"Bu danışmanın bilgilerine erişim yetkiniz yok"},{status:403});return n.vF.info("Danışman bilgileri başarıyla getirildi:",a),s.NextResponse.json({success:!0,advisor:{id:c.id,email:c.email,name:c.name,studentIds:c.studentIds||[],updatedAt:c.updated_at}})}catch(e){return n.vF.error("Danışman bilgisi getirme hatası:",e),s.NextResponse.json({error:"Danışman bilgisi alınamadı"},{status:500})}}i=(u.then?(await u)():u)[0],a()}catch(e){a(e)}})},64939:e=>{e.exports=import("pg")},70556:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{patchFetch:()=>l,routeModule:()=>d,serverHooks:()=>c,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>m});var s=t(96559),i=t(48088),n=t(37719),o=t(64263),u=e([o]);o=(u.then?(await u)():u)[0];let d=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/advisor/[email]/route",pathname:"/api/advisor/[email]",filename:"route",bundlePath:"app/api/advisor/[email]/route"},resolvedPagePath:"C:\\Users\\pc\\Downloads\\CG_Portal-main\\CG_Portal-main\\src\\app\\api\\advisor\\[email]\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:p,workUnitAsyncStorage:m,serverHooks:c}=d;function l(){return(0,n.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:m})}a()}catch(e){a(e)}})},79428:e=>{e.exports=require("buffer")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[4447,580,5315,8033],()=>t(70556));module.exports=a})();