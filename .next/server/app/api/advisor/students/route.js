/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/advisor/students/route";
exports.ids = ["app/api/advisor/students/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fadvisor%2Fstudents%2Froute&page=%2Fapi%2Fadvisor%2Fstudents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadvisor%2Fstudents%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fadvisor%2Fstudents%2Froute&page=%2Fapi%2Fadvisor%2Fstudents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadvisor%2Fstudents%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_pc_Downloads_CG_Portal_main_CG_Portal_main_src_app_api_advisor_students_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/advisor/students/route.ts */ \"(rsc)/./src/app/api/advisor/students/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([C_Users_pc_Downloads_CG_Portal_main_CG_Portal_main_src_app_api_advisor_students_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\nC_Users_pc_Downloads_CG_Portal_main_CG_Portal_main_src_app_api_advisor_students_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/advisor/students/route\",\n        pathname: \"/api/advisor/students\",\n        filename: \"route\",\n        bundlePath: \"app/api/advisor/students/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\pc\\\\Downloads\\\\CG_Portal-main\\\\CG_Portal-main\\\\src\\\\app\\\\api\\\\advisor\\\\students\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_pc_Downloads_CG_Portal_main_CG_Portal_main_src_app_api_advisor_students_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhZHZpc29yJTJGc3R1ZGVudHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFkdmlzb3IlMkZzdHVkZW50cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFkdmlzb3IlMkZzdHVkZW50cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNwYyU1Q0Rvd25sb2FkcyU1Q0NHX1BvcnRhbC1tYWluJTVDQ0dfUG9ydGFsLW1haW4lNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q3BjJTVDRG93bmxvYWRzJTVDQ0dfUG9ydGFsLW1haW4lNUNDR19Qb3J0YWwtbWFpbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDb0Q7QUFDakk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGLHFDIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXHBjXFxcXERvd25sb2Fkc1xcXFxDR19Qb3J0YWwtbWFpblxcXFxDR19Qb3J0YWwtbWFpblxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhZHZpc29yXFxcXHN0dWRlbnRzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hZHZpc29yL3N0dWRlbnRzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWR2aXNvci9zdHVkZW50c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWR2aXNvci9zdHVkZW50cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXHBjXFxcXERvd25sb2Fkc1xcXFxDR19Qb3J0YWwtbWFpblxcXFxDR19Qb3J0YWwtbWFpblxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhZHZpc29yXFxcXHN0dWRlbnRzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fadvisor%2Fstudents%2Froute&page=%2Fapi%2Fadvisor%2Fstudents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadvisor%2Fstudents%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/advisor/students/route.ts":
/*!***********************************************!*\
  !*** ./src/app/api/advisor/students/route.ts ***!
  \***********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/utils/logger */ \"(rsc)/./src/utils/logger.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_db__WEBPACK_IMPORTED_MODULE_1__]);\n_lib_db__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\nasync function GET(request) {\n    try {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info('Danışman öğrenci listesi isteği alındı');\n        // Kullanıcı e-postasını header'dan al\n        const userEmail = request.headers.get('x-user-email');\n        if (!userEmail) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error('Kullanıcı e-postası bulunamadı');\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: 'Kullanıcı e-postası gerekli'\n            }, {\n                status: 400\n            });\n        }\n        _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info('Danışman öğrenci listesi getiriliyor', {\n            userEmail\n        });\n        // Önce danışmanın varlığını kontrol et\n        const advisor = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getAdvisorByEmail)(userEmail);\n        if (!advisor) {\n            _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error('Danışman bulunamadı:', userEmail);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: 'Danışman bulunamadı'\n            }, {\n                status: 404\n            });\n        }\n        // Danışmanın öğrencilerini getir\n        const students = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getStudentsByAdvisor)(userEmail);\n        // Öğrenci verilerini formatla\n        const formattedStudents = students.map((student)=>({\n                id: student.email,\n                name: student.name,\n                email: student.email,\n                phone: student.phone || '',\n                stage: student.stage || 'Hazırlık Aşaması',\n                processStarted: student.process_started || false,\n                createdAt: student.created_at,\n                updatedAt: student.updated_at,\n                documents: student.documents || []\n            }));\n        _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.info('Danışman öğrenci listesi başarıyla getirildi', {\n            advisorEmail: userEmail,\n            studentCount: formattedStudents.length\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            students: formattedStudents\n        });\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_2__.logger.error('Danışman öğrenci listesi hatası:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Öğrenci listesi alınamadı'\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hZHZpc29yL3N0dWRlbnRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBd0Q7QUFDVztBQUMzQjtBQUVqQyxlQUFlSSxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0ZGLGlEQUFNQSxDQUFDRyxJQUFJLENBQUM7UUFFWixzQ0FBc0M7UUFDdEMsTUFBTUMsWUFBWUYsUUFBUUcsT0FBTyxDQUFDQyxHQUFHLENBQUM7UUFDdEMsSUFBSSxDQUFDRixXQUFXO1lBQ2RKLGlEQUFNQSxDQUFDTyxLQUFLLENBQUM7WUFDYixPQUFPVixxREFBWUEsQ0FBQ1csSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT0YsT0FBTztZQUE4QixHQUN2RDtnQkFBRUcsUUFBUTtZQUFJO1FBRWxCO1FBRUFWLGlEQUFNQSxDQUFDRyxJQUFJLENBQUMsd0NBQXdDO1lBQUVDO1FBQVU7UUFFaEUsdUNBQXVDO1FBQ3ZDLE1BQU1PLFVBQVUsTUFBTVosMERBQWlCQSxDQUFDSztRQUN4QyxJQUFJLENBQUNPLFNBQVM7WUFDWlgsaURBQU1BLENBQUNPLEtBQUssQ0FBQyx3QkFBd0JIO1lBQ3JDLE9BQU9QLHFEQUFZQSxDQUFDVyxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPRixPQUFPO1lBQXNCLEdBQy9DO2dCQUFFRyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxpQ0FBaUM7UUFDakMsTUFBTUUsV0FBVyxNQUFNZCw2REFBb0JBLENBQUNNO1FBRTVDLDhCQUE4QjtRQUM5QixNQUFNUyxvQkFBb0JELFNBQVNFLEdBQUcsQ0FBQ0MsQ0FBQUEsVUFBWTtnQkFDakRDLElBQUlELFFBQVFFLEtBQUs7Z0JBQ2pCQyxNQUFNSCxRQUFRRyxJQUFJO2dCQUNsQkQsT0FBT0YsUUFBUUUsS0FBSztnQkFDcEJFLE9BQU9KLFFBQVFJLEtBQUssSUFBSTtnQkFDeEJDLE9BQU9MLFFBQVFLLEtBQUssSUFBSTtnQkFDeEJDLGdCQUFnQk4sUUFBUU8sZUFBZSxJQUFJO2dCQUMzQ0MsV0FBV1IsUUFBUVMsVUFBVTtnQkFDN0JDLFdBQVdWLFFBQVFXLFVBQVU7Z0JBQzdCQyxXQUFXWixRQUFRWSxTQUFTLElBQUksRUFBRTtZQUNwQztRQUVBM0IsaURBQU1BLENBQUNHLElBQUksQ0FBQyxnREFBZ0Q7WUFDMUR5QixjQUFjeEI7WUFDZHlCLGNBQWNoQixrQkFBa0JpQixNQUFNO1FBQ3hDO1FBRUEsT0FBT2pDLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVEcsVUFBVUM7UUFDWjtJQUNGLEVBQUUsT0FBT04sT0FBTztRQUNkUCxpREFBTUEsQ0FBQ08sS0FBSyxDQUFDLG9DQUFvQ0E7UUFDakQsT0FBT1YscURBQVlBLENBQUNXLElBQUksQ0FDdEI7WUFBRUMsU0FBUztZQUFPRixPQUFPO1FBQTRCLEdBQ3JEO1lBQUVHLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHBjXFxEb3dubG9hZHNcXENHX1BvcnRhbC1tYWluXFxDR19Qb3J0YWwtbWFpblxcc3JjXFxhcHBcXGFwaVxcYWR2aXNvclxcc3R1ZGVudHNcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBnZXRTdHVkZW50c0J5QWR2aXNvciwgZ2V0QWR2aXNvckJ5RW1haWwgfSBmcm9tICdAL2xpYi9kYic7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBsb2dnZXIuaW5mbygnRGFuxLHFn21hbiDDtsSfcmVuY2kgbGlzdGVzaSBpc3RlxJ9pIGFsxLFuZMSxJyk7XG4gICAgXG4gICAgLy8gS3VsbGFuxLFjxLEgZS1wb3N0YXPEsW7EsSBoZWFkZXInZGFuIGFsXG4gICAgY29uc3QgdXNlckVtYWlsID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC11c2VyLWVtYWlsJyk7XG4gICAgaWYgKCF1c2VyRW1haWwpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignS3VsbGFuxLFjxLEgZS1wb3N0YXPEsSBidWx1bmFtYWTEsScpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0t1bGxhbsSxY8SxIGUtcG9zdGFzxLEgZ2VyZWtsaScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICBsb2dnZXIuaW5mbygnRGFuxLHFn21hbiDDtsSfcmVuY2kgbGlzdGVzaSBnZXRpcmlsaXlvcicsIHsgdXNlckVtYWlsIH0pO1xuXG4gICAgLy8gw5ZuY2UgZGFuxLHFn21hbsSxbiB2YXJsxLHEn8SxbsSxIGtvbnRyb2wgZXRcbiAgICBjb25zdCBhZHZpc29yID0gYXdhaXQgZ2V0QWR2aXNvckJ5RW1haWwodXNlckVtYWlsKTtcbiAgICBpZiAoIWFkdmlzb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRGFuxLHFn21hbiBidWx1bmFtYWTEsTonLCB1c2VyRW1haWwpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0RhbsSxxZ9tYW4gYnVsdW5hbWFkxLEnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBEYW7EscWfbWFuxLFuIMO2xJ9yZW5jaWxlcmluaSBnZXRpclxuICAgIGNvbnN0IHN0dWRlbnRzID0gYXdhaXQgZ2V0U3R1ZGVudHNCeUFkdmlzb3IodXNlckVtYWlsKTtcbiAgICBcbiAgICAvLyDDlsSfcmVuY2kgdmVyaWxlcmluaSBmb3JtYXRsYVxuICAgIGNvbnN0IGZvcm1hdHRlZFN0dWRlbnRzID0gc3R1ZGVudHMubWFwKHN0dWRlbnQgPT4gKHtcbiAgICAgIGlkOiBzdHVkZW50LmVtYWlsLFxuICAgICAgbmFtZTogc3R1ZGVudC5uYW1lLFxuICAgICAgZW1haWw6IHN0dWRlbnQuZW1haWwsXG4gICAgICBwaG9uZTogc3R1ZGVudC5waG9uZSB8fCAnJyxcbiAgICAgIHN0YWdlOiBzdHVkZW50LnN0YWdlIHx8ICdIYXrEsXJsxLFrIEHFn2FtYXPEsScsXG4gICAgICBwcm9jZXNzU3RhcnRlZDogc3R1ZGVudC5wcm9jZXNzX3N0YXJ0ZWQgfHwgZmFsc2UsXG4gICAgICBjcmVhdGVkQXQ6IHN0dWRlbnQuY3JlYXRlZF9hdCxcbiAgICAgIHVwZGF0ZWRBdDogc3R1ZGVudC51cGRhdGVkX2F0LFxuICAgICAgZG9jdW1lbnRzOiBzdHVkZW50LmRvY3VtZW50cyB8fCBbXVxuICAgIH0pKTtcblxuICAgIGxvZ2dlci5pbmZvKCdEYW7EscWfbWFuIMO2xJ9yZW5jaSBsaXN0ZXNpIGJhxZ9hcsSxeWxhIGdldGlyaWxkaScsIHsgXG4gICAgICBhZHZpc29yRW1haWw6IHVzZXJFbWFpbCxcbiAgICAgIHN0dWRlbnRDb3VudDogZm9ybWF0dGVkU3R1ZGVudHMubGVuZ3RoIFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBzdHVkZW50czogZm9ybWF0dGVkU3R1ZGVudHNcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0RhbsSxxZ9tYW4gw7bEn3JlbmNpIGxpc3Rlc2kgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICfDlsSfcmVuY2kgbGlzdGVzaSBhbMSxbmFtYWTEsScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldFN0dWRlbnRzQnlBZHZpc29yIiwiZ2V0QWR2aXNvckJ5RW1haWwiLCJsb2dnZXIiLCJHRVQiLCJyZXF1ZXN0IiwiaW5mbyIsInVzZXJFbWFpbCIsImhlYWRlcnMiLCJnZXQiLCJlcnJvciIsImpzb24iLCJzdWNjZXNzIiwic3RhdHVzIiwiYWR2aXNvciIsInN0dWRlbnRzIiwiZm9ybWF0dGVkU3R1ZGVudHMiLCJtYXAiLCJzdHVkZW50IiwiaWQiLCJlbWFpbCIsIm5hbWUiLCJwaG9uZSIsInN0YWdlIiwicHJvY2Vzc1N0YXJ0ZWQiLCJwcm9jZXNzX3N0YXJ0ZWQiLCJjcmVhdGVkQXQiLCJjcmVhdGVkX2F0IiwidXBkYXRlZEF0IiwidXBkYXRlZF9hdCIsImRvY3VtZW50cyIsImFkdmlzb3JFbWFpbCIsInN0dWRlbnRDb3VudCIsImxlbmd0aCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/advisor/students/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addStudentDocument: () => (/* binding */ addStudentDocument),\n/* harmony export */   createMessage: () => (/* binding */ createMessage),\n/* harmony export */   createStudent: () => (/* binding */ createStudent),\n/* harmony export */   createTables: () => (/* binding */ createTables),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getAdvisorByEmail: () => (/* binding */ getAdvisorByEmail),\n/* harmony export */   getAllStudents: () => (/* binding */ getAllStudents),\n/* harmony export */   getConversationsByUser: () => (/* binding */ getConversationsByUser),\n/* harmony export */   getDocumentsByStudentId: () => (/* binding */ getDocumentsByStudentId),\n/* harmony export */   getMessagesBetweenUsers: () => (/* binding */ getMessagesBetweenUsers),\n/* harmony export */   getMessagesByUser: () => (/* binding */ getMessagesByUser),\n/* harmony export */   getStudentByEmail: () => (/* binding */ getStudentByEmail),\n/* harmony export */   getStudentsByAdvisor: () => (/* binding */ getStudentsByAdvisor),\n/* harmony export */   getUnreadMessageCount: () => (/* binding */ getUnreadMessageCount),\n/* harmony export */   markMessageAsRead: () => (/* binding */ markMessageAsRead),\n/* harmony export */   pool: () => (/* binding */ pool),\n/* harmony export */   saveDocument: () => (/* binding */ saveDocument),\n/* harmony export */   startStudentProcess: () => (/* binding */ startStudentProcess),\n/* harmony export */   updateStudentDocument: () => (/* binding */ updateStudentDocument),\n/* harmony export */   updateStudentProcess: () => (/* binding */ updateStudentProcess),\n/* harmony export */   updateStudentProfile: () => (/* binding */ updateStudentProfile),\n/* harmony export */   updateStudentStage: () => (/* binding */ updateStudentStage)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var _utils_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/logger */ \"(rsc)/./src/utils/logger.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_0__]);\npg__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nif (!process.env.POSTGRES_PASSWORD) {\n    throw new Error('POSTGRES_PASSWORD environment variable is not set');\n}\n// PostgreSQL bağlantı havuzu\nconst pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n    user: process.env.POSTGRES_USER || 'postgres',\n    host: process.env.POSTGRES_HOST || 'localhost',\n    database: process.env.POSTGRES_DATABASE || 'cg_portal',\n    password: process.env.POSTGRES_PASSWORD,\n    port: parseInt(process.env.POSTGRES_PORT || '5432'),\n    ssl: false // SSL'i devre dışı bırak\n});\n// Bağlantı testi\npool.on('connect', ()=>{\n    _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('Veritabanına bağlantı başarılı');\n});\npool.on('error', (err)=>{\n    _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Veritabanı bağlantı hatası:', err);\n});\n// Öğrenci işlemleri\nasync function getStudentByEmail(email) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('SELECT * FROM students WHERE email = $1', [\n            email\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getAdvisorByEmail(email) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('SELECT * FROM advisors WHERE email = $1', [\n            email\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Danışman getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getStudentsByAdvisor(advisorEmail) {\n    const client = await pool.connect();\n    try {\n        const query = `\n      SELECT \n        s.*,\n        json_agg(\n          json_build_object(\n            'documentType', d.document_type,\n            'documentUrl', d.file_path,\n            'documentName', d.file_name,\n            'updatedAt', d.upload_date\n          )\n        ) FILTER (WHERE d.id IS NOT NULL) as documents\n      FROM students s\n      LEFT JOIN documents d ON s.id = d.student_id\n      WHERE s.advisor_email = $1\n      GROUP BY s.id, s.email, s.name, s.phone, s.stage, s.process_started, s.created_at, s.updated_at, s.advisor_id, s.advisor_email\n      ORDER BY s.updated_at DESC\n    `;\n        const result = await client.query(query, [\n            advisorEmail\n        ]);\n        return result.rows;\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Danışman öğrencileri getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function updateStudentProcess(email, processStarted) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('UPDATE students SET process_started = $1, updated_at = NOW() WHERE email = $2 RETURNING *', [\n            processStarted,\n            email\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci süreç güncelleme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function updateStudentStage(email, stage) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('UPDATE students SET stage = $1, updated_at = NOW() WHERE email = $2 RETURNING *', [\n            stage,\n            email\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci aşama güncelleme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function saveDocument(studentId, documentType, filePath, fileName) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('INSERT INTO documents (student_id, document_type, file_path, file_name, upload_date) VALUES ($1, $2, $3, $4, NOW()) RETURNING *', [\n            studentId,\n            documentType,\n            filePath,\n            fileName\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Döküman kaydetme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getDocumentsByStudentId(studentId) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('SELECT * FROM documents WHERE student_id = $1 ORDER BY upload_date DESC', [\n            studentId\n        ]);\n        return result.rows;\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci dökümanları getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\n// Tüm öğrencileri getir\nasync function getAllStudents() {\n    const client = await pool.connect();\n    try {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('getAllStudents: Veritabanı bağlantısı kuruldu');\n        const query = `\n      SELECT \n        s.*,\n        COALESCE(a.name, 'Atanmadı') as advisor_name,\n        a.email as advisor_email\n      FROM students s\n      LEFT JOIN advisors a ON s.advisor_email = a.email\n      ORDER BY s.created_at DESC\n    `;\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('getAllStudents: SQL sorgusu hazırlandı:', query);\n        const result = await client.query(query);\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('getAllStudents: Sorgu sonucu:', {\n            rowCount: result.rowCount,\n            rows: result.rows\n        });\n        return result.rows;\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('getAllStudents hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('getAllStudents: Veritabanı bağlantısı kapatıldı');\n    }\n}\n// Öğrenci profilini güncelle\nasync function updateStudentProfile(email, data) {\n    let client;\n    try {\n        client = await pool.connect();\n        // Güncellenebilir alanları belirle\n        const updateFields = [\n            'name',\n            'phone',\n            'birth_date',\n            'birth_place',\n            'marital_status',\n            'contact_address',\n            'passport_number',\n            'passport_type',\n            'passport_issue_date',\n            'passport_expiry_date',\n            'issuing_authority',\n            'high_school_name',\n            'high_school_type',\n            'high_school_city',\n            'high_school_start_date',\n            'high_school_graduation_date',\n            'university_name',\n            'university_department',\n            'university_start_date',\n            'university_end_date',\n            'graduation_status',\n            'graduation_year',\n            'university_preferences',\n            'german_department_preference',\n            'language_level',\n            'language_certificate',\n            'language_course_registration',\n            'language_learning_status',\n            'visa_consulate',\n            'visa_application_date',\n            'visa_appointment_date',\n            'visa_document',\n            'financial_proof',\n            'financial_proof_status',\n            'exam_entry',\n            'exam_result_date',\n            'mother_name',\n            'mother_surname',\n            'mother_birth_date',\n            'mother_birth_place',\n            'mother_residence',\n            'mother_phone',\n            'father_name',\n            'father_surname',\n            'father_birth_date',\n            'father_birth_place',\n            'father_residence',\n            'father_phone'\n        ];\n        // Güncellenecek alanları ve değerleri hazırla\n        const updates = [];\n        const values = [];\n        let paramIndex = 1;\n        for (const field of updateFields){\n            const value = data[field];\n            if (value !== undefined) {\n                updates.push(`${field} = $${paramIndex}`);\n                values.push(value);\n                paramIndex++;\n            }\n        }\n        if (updates.length === 0) {\n            throw new Error('Güncellenecek alan bulunamadı');\n        }\n        // updated_at alanını ekle\n        updates.push(`updated_at = NOW()`);\n        values.push(email);\n        const query = `\n      UPDATE students \n      SET ${updates.join(', ')}\n      WHERE email = $${paramIndex}\n      RETURNING *\n    `;\n        const result = await client.query(query, values);\n        if (result.rows.length === 0) {\n            throw new Error('Öğrenci bulunamadı');\n        }\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci profil güncelleme hatası:', error);\n        throw error;\n    } finally{\n        if (client) {\n            client.release();\n        }\n    }\n}\n// Öğrenci belgesi ekle\nasync function addStudentDocument(email, document) {\n    let client;\n    try {\n        client = await pool.connect();\n        const query = `\n      INSERT INTO documents (\n        student_email,\n        document_type,\n        file_name,\n        file_path,\n        upload_date,\n        status\n      ) VALUES ($1, $2, $3, $4, NOW(), 'pending')\n      RETURNING *\n    `;\n        const values = [\n            email,\n            document.documentType,\n            document.documentName,\n            document.documentUrl\n        ];\n        const result = await client.query(query, values);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Belge ekleme hatası:', error);\n        throw error;\n    } finally{\n        if (client) {\n            client.release();\n        }\n    }\n}\n// Öğrenci belgesini güncelle\nasync function updateStudentDocument(documentId, status) {\n    let client;\n    try {\n        client = await pool.connect();\n        const query = `\n      UPDATE documents \n      SET status = $1, updated_at = NOW()\n      WHERE id = $2\n      RETURNING *\n    `;\n        const result = await client.query(query, [\n            status,\n            documentId\n        ]);\n        if (result.rows.length === 0) {\n            throw new Error('Belge bulunamadı');\n        }\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Belge güncelleme hatası:', error);\n        throw error;\n    } finally{\n        if (client) {\n            client.release();\n        }\n    }\n}\n// Öğrenci sürecini başlat\nasync function startStudentProcess(email, advisorEmail) {\n    let client;\n    try {\n        client = await pool.connect();\n        const query = `\n      UPDATE students \n      SET \n        process_started = true,\n        process_start_date = NOW(),\n        stage = 'Süreç Başlatıldı',\n        advisor_email = $1,\n        updated_at = NOW()\n      WHERE email = $2\n      RETURNING *\n    `;\n        const result = await client.query(query, [\n            advisorEmail,\n            email\n        ]);\n        if (result.rows.length === 0) {\n            throw new Error('Öğrenci bulunamadı');\n        }\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci süreç başlatma hatası:', error);\n        throw error;\n    } finally{\n        if (client) {\n            client.release();\n        }\n    }\n}\n// Yeni öğrenci oluştur\nasync function createStudent(data) {\n    let client;\n    try {\n        client = await pool.connect();\n        const query = `\n      INSERT INTO students (\n        email,\n        name,\n        phone,\n        stage,\n        process_started,\n        created_at,\n        updated_at,\n        advisor_id,\n        advisor_name,\n        advisor_email\n      ) VALUES ($1, $2, $3, $4, $5, NOW(), NOW(), $6, $7, $8)\n      RETURNING *\n    `;\n        const values = [\n            data.email,\n            data.name,\n            data.phone || '',\n            data.stage || 'new',\n            data.process_started || false,\n            data.advisor_id || null,\n            data.advisor_name || null,\n            data.advisor_email || null\n        ];\n        const result = await client.query(query, values);\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('Yeni öğrenci oluşturuldu:', {\n            email: data.email\n        });\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Öğrenci oluşturma hatası:', error);\n        throw error;\n    } finally{\n        if (client) {\n            client.release();\n        }\n    }\n}\n// Veritabanı tablolarını oluştur\nasync function createTables() {\n    let client;\n    try {\n        client = await pool.connect();\n        // Öğrenciler tablosu\n        await client.query(`\n      CREATE TABLE IF NOT EXISTS students (\n        id SERIAL PRIMARY KEY,\n        email VARCHAR(255) UNIQUE NOT NULL,\n        name VARCHAR(255),\n        phone VARCHAR(50),\n        stage VARCHAR(100) DEFAULT 'new',\n        process_started BOOLEAN DEFAULT FALSE,\n        process_start_date TIMESTAMP WITH TIME ZONE,\n        created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n        updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n        advisor_id INTEGER REFERENCES advisors(id),\n        advisor_name VARCHAR(255),\n        advisor_email VARCHAR(255),\n        sales_id VARCHAR(255),\n        sales_name VARCHAR(255),\n        sales_email VARCHAR(255),\n        lead_id VARCHAR(255),\n        contact_address TEXT,\n        age INTEGER,\n        birth_date DATE,\n        birth_place VARCHAR(255),\n        marital_status VARCHAR(50),\n        passport_number VARCHAR(50),\n        passport_type VARCHAR(100),\n        passport_issue_date DATE,\n        passport_expiry_date DATE,\n        issuing_authority VARCHAR(255),\n        pnr_number VARCHAR(50),\n        visa_application_date DATE,\n        visa_appointment_date DATE,\n        visa_document VARCHAR(255),\n        visa_consulate VARCHAR(255),\n        has_been_to_germany BOOLEAN DEFAULT FALSE,\n        high_school_name VARCHAR(255),\n        high_school_type VARCHAR(100),\n        high_school_city VARCHAR(255),\n        high_school_start_date DATE,\n        high_school_graduation_date DATE,\n        university_name VARCHAR(255),\n        university_department VARCHAR(255),\n        university_start_date DATE,\n        university_end_date DATE,\n        graduation_status VARCHAR(50),\n        graduation_year INTEGER,\n        university_preferences TEXT[],\n        german_department_preference VARCHAR(255),\n        language_level VARCHAR(50),\n        language_certificate VARCHAR(255),\n        language_course_registration VARCHAR(255),\n        language_learning_status VARCHAR(50),\n        financial_proof VARCHAR(255),\n        financial_proof_status VARCHAR(50),\n        exam_entry BOOLEAN DEFAULT FALSE,\n        exam_result_date DATE,\n        mother_name VARCHAR(255),\n        mother_surname VARCHAR(255),\n        mother_birth_date DATE,\n        mother_birth_place VARCHAR(255),\n        mother_residence VARCHAR(255),\n        mother_phone VARCHAR(50),\n        father_name VARCHAR(255),\n        father_surname VARCHAR(255),\n        father_birth_date DATE,\n        father_birth_place VARCHAR(255),\n        father_residence VARCHAR(255),\n        father_phone VARCHAR(50),\n        webhook_updated BOOLEAN DEFAULT FALSE,\n        webhook_update_timestamp TIMESTAMP WITH TIME ZONE\n      );\n    `);\n        // Danışmanlar tablosu\n        await client.query(`\n      CREATE TABLE IF NOT EXISTS advisors (\n        id SERIAL PRIMARY KEY,\n        email VARCHAR(255) UNIQUE NOT NULL,\n        name VARCHAR(255) NOT NULL,\n        created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n        updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP\n      );\n    `);\n        // Mesajlar tablosu\n        await client.query(`\n      CREATE TABLE IF NOT EXISTS messages (\n        id SERIAL PRIMARY KEY,\n        sender_email VARCHAR(255) NOT NULL,\n        receiver_email VARCHAR(255) NOT NULL,\n        sender_role VARCHAR(50) NOT NULL,\n        content TEXT NOT NULL,\n        subject VARCHAR(255),\n        category VARCHAR(50) DEFAULT 'general',\n        reply_to_id INTEGER REFERENCES messages(id),\n        created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n        is_read BOOLEAN DEFAULT FALSE,\n        CONSTRAINT valid_sender_role CHECK (sender_role IN ('student', 'advisor'))\n      );\n    `);\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.info('Veritabanı tabloları başarıyla oluşturuldu');\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Veritabanı tabloları oluşturma hatası:', error);\n        throw error;\n    } finally{\n        if (client) {\n            client.release();\n        }\n    }\n}\n// Uygulama başladığında tabloları oluştur\ncreateTables().catch((error)=>{\n    _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Tablolar oluşturulurken hata:', error);\n    process.exit(1);\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n// Mesaj işlemleri\nasync function createMessage(data) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query(`INSERT INTO messages (sender_email, receiver_email, sender_role, content, subject, category, reply_to_id, created_at) \n       VALUES ($1, $2, $3, $4, $5, $6, $7, NOW()) \n       RETURNING *`, [\n            data.senderEmail.toLowerCase(),\n            data.receiverEmail.toLowerCase(),\n            data.senderRole,\n            data.content,\n            data.subject || null,\n            data.category || 'general',\n            data.replyToId || null\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Mesaj oluşturma hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getMessagesByUser(email) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query(`SELECT * FROM messages \n       WHERE sender_email = $1 OR receiver_email = $1 \n       ORDER BY created_at DESC`, [\n            email.toLowerCase()\n        ]);\n        return result.rows;\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Kullanıcı mesajları getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getConversationsByUser(email) {\n    const client = await pool.connect();\n    try {\n        // Kullanıcının katıldığı tüm konuşmaları getir\n        const result = await client.query(`SELECT DISTINCT \n         CASE \n           WHEN sender_email = $1 THEN receiver_email \n           ELSE sender_email \n         END as other_participant,\n         MIN(created_at) as first_message,\n         MAX(created_at) as last_message,\n         COUNT(*) as message_count,\n         SUM(CASE WHEN is_read = false AND receiver_email = $1 THEN 1 ELSE 0 END) as unread_count\n       FROM messages \n       WHERE sender_email = $1 OR receiver_email = $1 \n       GROUP BY other_participant\n       ORDER BY last_message DESC`, [\n            email.toLowerCase()\n        ]);\n        return result.rows;\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Kullanıcı konuşmaları getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getMessagesBetweenUsers(user1, user2) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query(`SELECT * FROM messages \n       WHERE (sender_email = $1 AND receiver_email = $2) \n          OR (sender_email = $2 AND receiver_email = $1) \n       ORDER BY created_at ASC`, [\n            user1.toLowerCase(),\n            user2.toLowerCase()\n        ]);\n        return result.rows;\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('İki kullanıcı arası mesajlar getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function markMessageAsRead(messageId) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('UPDATE messages SET is_read = true WHERE id = $1 RETURNING *', [\n            messageId\n        ]);\n        return result.rows[0];\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Mesaj okundu işaretleme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\nasync function getUnreadMessageCount(email) {\n    const client = await pool.connect();\n    try {\n        const result = await client.query('SELECT COUNT(*) as count FROM messages WHERE receiver_email = $1 AND is_read = false', [\n            email.toLowerCase()\n        ]);\n        return parseInt(result.rows[0].count);\n    } catch (error) {\n        _utils_logger__WEBPACK_IMPORTED_MODULE_1__.logger.error('Okunmamış mesaj sayısı getirme hatası:', error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM7Ozs4QkFHdUIsQ0FBQyxFQUN6QjtZQUFDNEQsTUFBTVYsV0FBVztZQUFJVyxNQUFNWCxXQUFXO1NBQUc7UUFFNUMsT0FBT25ELE9BQU9FLElBQUk7SUFDcEIsRUFBRSxPQUFPUCxPQUFPO1FBQ2RwQixpREFBTUEsQ0FBQ29CLEtBQUssQ0FBQyxnREFBZ0RBO1FBQzdELE1BQU1BO0lBQ1IsU0FBVTtRQUNSRyxPQUFPSyxPQUFPO0lBQ2hCO0FBQ0Y7QUFFTyxlQUFlNEQsa0JBQWtCQyxTQUFpQjtJQUN2RCxNQUFNbEUsU0FBUyxNQUFNbEIsS0FBS21CLE9BQU87SUFDakMsSUFBSTtRQUNGLE1BQU1DLFNBQVMsTUFBTUYsT0FBT0csS0FBSyxDQUMvQixnRUFDQTtZQUFDK0Q7U0FBVTtRQUViLE9BQU9oRSxPQUFPRSxJQUFJLENBQUMsRUFBRTtJQUN2QixFQUFFLE9BQU9QLE9BQU87UUFDZHBCLGlEQUFNQSxDQUFDb0IsS0FBSyxDQUFDLG1DQUFtQ0E7UUFDaEQsTUFBTUE7SUFDUixTQUFVO1FBQ1JHLE9BQU9LLE9BQU87SUFDaEI7QUFDRjtBQUVPLGVBQWU4RCxzQkFBc0JwRSxLQUFhO0lBQ3ZELE1BQU1DLFNBQVMsTUFBTWxCLEtBQUttQixPQUFPO0lBQ2pDLElBQUk7UUFDRixNQUFNQyxTQUFTLE1BQU1GLE9BQU9HLEtBQUssQ0FDL0Isd0ZBQ0E7WUFBQ0osTUFBTXNELFdBQVc7U0FBRztRQUV2QixPQUFPOUQsU0FBU1csT0FBT0UsSUFBSSxDQUFDLEVBQUUsQ0FBQ2dFLEtBQUs7SUFDdEMsRUFBRSxPQUFPdkUsT0FBTztRQUNkcEIsaURBQU1BLENBQUNvQixLQUFLLENBQUMsMENBQTBDQTtRQUN2RCxNQUFNQTtJQUNSLFNBQVU7UUFDUkcsT0FBT0ssT0FBTztJQUNoQjtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHBjXFxEb3dubG9hZHNcXENHX1BvcnRhbC1tYWluXFxDR19Qb3J0YWwtbWFpblxcc3JjXFxsaWJcXGRiLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvb2wgfSBmcm9tICdwZyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcic7XG5cbmlmICghcHJvY2Vzcy5lbnYuUE9TVEdSRVNfUEFTU1dPUkQpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdQT1NUR1JFU19QQVNTV09SRCBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyBub3Qgc2V0Jyk7XG59XG5cbi8vIFBvc3RncmVTUUwgYmHEn2xhbnTEsSBoYXZ1enVcbmV4cG9ydCBjb25zdCBwb29sID0gbmV3IFBvb2woe1xuICB1c2VyOiBwcm9jZXNzLmVudi5QT1NUR1JFU19VU0VSIHx8ICdwb3N0Z3JlcycsXG4gIGhvc3Q6IHByb2Nlc3MuZW52LlBPU1RHUkVTX0hPU1QgfHwgJ2xvY2FsaG9zdCcsXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5QT1NUR1JFU19EQVRBQkFTRSB8fCAnY2dfcG9ydGFsJyxcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LlBPU1RHUkVTX1BBU1NXT1JELFxuICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5QT1NUR1JFU19QT1JUIHx8ICc1NDMyJyksXG4gIHNzbDogZmFsc2UgLy8gU1NMJ2kgZGV2cmUgZMSxxZ/EsSBixLFyYWtcbn0pO1xuXG4vLyBCYcSfbGFudMSxIHRlc3RpXG5wb29sLm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICBsb2dnZXIuaW5mbygnVmVyaXRhYmFuxLFuYSBiYcSfbGFudMSxIGJhxZ9hcsSxbMSxJyk7XG59KTtcblxucG9vbC5vbignZXJyb3InLCAoZXJyKSA9PiB7XG4gIGxvZ2dlci5lcnJvcignVmVyaXRhYmFuxLEgYmHEn2xhbnTEsSBoYXRhc8SxOicsIGVycik7XG59KTtcblxuLy8gw5bEn3JlbmNpIGnFn2xlbWxlcmlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdHVkZW50QnlFbWFpbChlbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IHBvb2wuY29ubmVjdCgpO1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIHN0dWRlbnRzIFdIRVJFIGVtYWlsID0gJDEnLFxuICAgICAgW2VtYWlsXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignw5bEn3JlbmNpIGdldGlybWUgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWR2aXNvckJ5RW1haWwoZW1haWw6IHN0cmluZykge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAnU0VMRUNUICogRlJPTSBhZHZpc29ycyBXSEVSRSBlbWFpbCA9ICQxJyxcbiAgICAgIFtlbWFpbF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0RhbsSxxZ9tYW4gZ2V0aXJtZSBoYXRhc8SxOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBmaW5hbGx5IHtcbiAgICBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdHVkZW50c0J5QWR2aXNvcihhZHZpc29yRW1haWw6IHN0cmluZykge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgcy4qLFxuICAgICAgICBqc29uX2FnZyhcbiAgICAgICAgICBqc29uX2J1aWxkX29iamVjdChcbiAgICAgICAgICAgICdkb2N1bWVudFR5cGUnLCBkLmRvY3VtZW50X3R5cGUsXG4gICAgICAgICAgICAnZG9jdW1lbnRVcmwnLCBkLmZpbGVfcGF0aCxcbiAgICAgICAgICAgICdkb2N1bWVudE5hbWUnLCBkLmZpbGVfbmFtZSxcbiAgICAgICAgICAgICd1cGRhdGVkQXQnLCBkLnVwbG9hZF9kYXRlXG4gICAgICAgICAgKVxuICAgICAgICApIEZJTFRFUiAoV0hFUkUgZC5pZCBJUyBOT1QgTlVMTCkgYXMgZG9jdW1lbnRzXG4gICAgICBGUk9NIHN0dWRlbnRzIHNcbiAgICAgIExFRlQgSk9JTiBkb2N1bWVudHMgZCBPTiBzLmlkID0gZC5zdHVkZW50X2lkXG4gICAgICBXSEVSRSBzLmFkdmlzb3JfZW1haWwgPSAkMVxuICAgICAgR1JPVVAgQlkgcy5pZCwgcy5lbWFpbCwgcy5uYW1lLCBzLnBob25lLCBzLnN0YWdlLCBzLnByb2Nlc3Nfc3RhcnRlZCwgcy5jcmVhdGVkX2F0LCBzLnVwZGF0ZWRfYXQsIHMuYWR2aXNvcl9pZCwgcy5hZHZpc29yX2VtYWlsXG4gICAgICBPUkRFUiBCWSBzLnVwZGF0ZWRfYXQgREVTQ1xuICAgIGA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkocXVlcnksIFthZHZpc29yRW1haWxdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdEYW7EscWfbWFuIMO2xJ9yZW5jaWxlcmkgZ2V0aXJtZSBoYXRhc8SxOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBmaW5hbGx5IHtcbiAgICBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVTdHVkZW50UHJvY2VzcyhlbWFpbDogc3RyaW5nLCBwcm9jZXNzU3RhcnRlZDogYm9vbGVhbikge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAnVVBEQVRFIHN0dWRlbnRzIFNFVCBwcm9jZXNzX3N0YXJ0ZWQgPSAkMSwgdXBkYXRlZF9hdCA9IE5PVygpIFdIRVJFIGVtYWlsID0gJDIgUkVUVVJOSU5HIConLFxuICAgICAgW3Byb2Nlc3NTdGFydGVkLCBlbWFpbF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ8OWxJ9yZW5jaSBzw7xyZcOnIGfDvG5jZWxsZW1lIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0dWRlbnRTdGFnZShlbWFpbDogc3RyaW5nLCBzdGFnZTogc3RyaW5nKSB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IHBvb2wuY29ubmVjdCgpO1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeShcbiAgICAgICdVUERBVEUgc3R1ZGVudHMgU0VUIHN0YWdlID0gJDEsIHVwZGF0ZWRfYXQgPSBOT1coKSBXSEVSRSBlbWFpbCA9ICQyIFJFVFVSTklORyAqJyxcbiAgICAgIFtzdGFnZSwgZW1haWxdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCfDlsSfcmVuY2kgYcWfYW1hIGfDvG5jZWxsZW1lIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVEb2N1bWVudChzdHVkZW50SWQ6IHN0cmluZywgZG9jdW1lbnRUeXBlOiBzdHJpbmcsIGZpbGVQYXRoOiBzdHJpbmcsIGZpbGVOYW1lOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgJ0lOU0VSVCBJTlRPIGRvY3VtZW50cyAoc3R1ZGVudF9pZCwgZG9jdW1lbnRfdHlwZSwgZmlsZV9wYXRoLCBmaWxlX25hbWUsIHVwbG9hZF9kYXRlKSBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCBOT1coKSkgUkVUVVJOSU5HIConLFxuICAgICAgW3N0dWRlbnRJZCwgZG9jdW1lbnRUeXBlLCBmaWxlUGF0aCwgZmlsZU5hbWVdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdEw7Zrw7xtYW4ga2F5ZGV0bWUgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RG9jdW1lbnRzQnlTdHVkZW50SWQoc3R1ZGVudElkOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCAqIEZST00gZG9jdW1lbnRzIFdIRVJFIHN0dWRlbnRfaWQgPSAkMSBPUkRFUiBCWSB1cGxvYWRfZGF0ZSBERVNDJyxcbiAgICAgIFtzdHVkZW50SWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCfDlsSfcmVuY2kgZMO2a8O8bWFubGFyxLEgZ2V0aXJtZSBoYXRhc8SxOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBmaW5hbGx5IHtcbiAgICBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbi8vIFZlcmkgdGlwbGVyaVxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21lclJlY29yZCB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIHBob25lPzogc3RyaW5nO1xuICBiaXJ0aF9kYXRlPzogc3RyaW5nO1xuICBiaXJ0aF9wbGFjZT86IHN0cmluZztcbiAgbWFyaXRhbF9zdGF0dXM/OiBzdHJpbmc7XG4gIGNvbnRhY3RfYWRkcmVzcz86IHN0cmluZztcbiAgcGFzc3BvcnRfbnVtYmVyPzogc3RyaW5nO1xuICBwYXNzcG9ydF90eXBlPzogc3RyaW5nO1xuICBwYXNzcG9ydF9pc3N1ZV9kYXRlPzogc3RyaW5nO1xuICBwYXNzcG9ydF9leHBpcnlfZGF0ZT86IHN0cmluZztcbiAgaXNzdWluZ19hdXRob3JpdHk/OiBzdHJpbmc7XG4gIGhpZ2hfc2Nob29sX25hbWU/OiBzdHJpbmc7XG4gIGhpZ2hfc2Nob29sX3R5cGU/OiBzdHJpbmc7XG4gIGhpZ2hfc2Nob29sX2NpdHk/OiBzdHJpbmc7XG4gIGhpZ2hfc2Nob29sX3N0YXJ0X2RhdGU/OiBzdHJpbmc7XG4gIGhpZ2hfc2Nob29sX2dyYWR1YXRpb25fZGF0ZT86IHN0cmluZztcbiAgdW5pdmVyc2l0eV9uYW1lPzogc3RyaW5nO1xuICB1bml2ZXJzaXR5X2RlcGFydG1lbnQ/OiBzdHJpbmc7XG4gIHVuaXZlcnNpdHlfc3RhcnRfZGF0ZT86IHN0cmluZztcbiAgdW5pdmVyc2l0eV9lbmRfZGF0ZT86IHN0cmluZztcbiAgZ3JhZHVhdGlvbl9zdGF0dXM/OiBzdHJpbmc7XG4gIGdyYWR1YXRpb25feWVhcj86IHN0cmluZztcbiAgdW5pdmVyc2l0eV9wcmVmZXJlbmNlcz86IHN0cmluZ1tdO1xuICBnZXJtYW5fZGVwYXJ0bWVudF9wcmVmZXJlbmNlPzogc3RyaW5nO1xuICBsYW5ndWFnZV9sZXZlbD86IHN0cmluZztcbiAgbGFuZ3VhZ2VfY2VydGlmaWNhdGU/OiBzdHJpbmc7XG4gIGxhbmd1YWdlX2NvdXJzZV9yZWdpc3RyYXRpb24/OiBzdHJpbmc7XG4gIGxhbmd1YWdlX2xlYXJuaW5nX3N0YXR1cz86IHN0cmluZztcbiAgdmlzYV9jb25zdWxhdGU/OiBzdHJpbmc7XG4gIHZpc2FfYXBwbGljYXRpb25fZGF0ZT86IHN0cmluZztcbiAgdmlzYV9hcHBvaW50bWVudF9kYXRlPzogc3RyaW5nO1xuICB2aXNhX2RvY3VtZW50Pzogc3RyaW5nO1xuICBmaW5hbmNpYWxfcHJvb2Y/OiBzdHJpbmc7XG4gIGZpbmFuY2lhbF9wcm9vZl9zdGF0dXM/OiBzdHJpbmc7XG4gIGV4YW1fZW50cnk/OiBzdHJpbmc7XG4gIGV4YW1fcmVzdWx0X2RhdGU/OiBzdHJpbmc7XG4gIG1vdGhlcl9uYW1lPzogc3RyaW5nO1xuICBtb3RoZXJfc3VybmFtZT86IHN0cmluZztcbiAgbW90aGVyX2JpcnRoX2RhdGU/OiBzdHJpbmc7XG4gIG1vdGhlcl9iaXJ0aF9wbGFjZT86IHN0cmluZztcbiAgbW90aGVyX3Jlc2lkZW5jZT86IHN0cmluZztcbiAgbW90aGVyX3Bob25lPzogc3RyaW5nO1xuICBmYXRoZXJfbmFtZT86IHN0cmluZztcbiAgZmF0aGVyX3N1cm5hbWU/OiBzdHJpbmc7XG4gIGZhdGhlcl9iaXJ0aF9kYXRlPzogc3RyaW5nO1xuICBmYXRoZXJfYmlydGhfcGxhY2U/OiBzdHJpbmc7XG4gIGZhdGhlcl9yZXNpZGVuY2U/OiBzdHJpbmc7XG4gIGZhdGhlcl9waG9uZT86IHN0cmluZztcbiAgc3RhZ2U/OiBzdHJpbmc7XG4gIHByb2Nlc3Nfc3RhcnRlZD86IGJvb2xlYW47XG4gIHByb2Nlc3Nfc3RhcnRfZGF0ZT86IHN0cmluZztcbiAgYWR2aXNvcl9lbWFpbD86IHN0cmluZztcbiAgYWR2aXNvcl9pZD86IHN0cmluZztcbiAgYWR2aXNvcl9uYW1lPzogc3RyaW5nO1xuICBjcmVhdGVkX2F0Pzogc3RyaW5nO1xuICB1cGRhdGVkX2F0Pzogc3RyaW5nO1xuICBkb2N1bWVudHM/OiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBkb2N1bWVudFR5cGU6IHN0cmluZztcbiAgICBkb2N1bWVudE5hbWU6IHN0cmluZztcbiAgICBkb2N1bWVudFVybDogc3RyaW5nO1xuICAgIHVwbG9hZERhdGU6IHN0cmluZztcbiAgICBzdGF0dXM6IHN0cmluZztcbiAgfT47XG59XG5cbi8vIFTDvG0gw7bEn3JlbmNpbGVyaSBnZXRpclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFsbFN0dWRlbnRzKCkge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBsb2dnZXIuaW5mbygnZ2V0QWxsU3R1ZGVudHM6IFZlcml0YWJhbsSxIGJhxJ9sYW50xLFzxLEga3VydWxkdScpO1xuICAgIFxuICAgIGNvbnN0IHF1ZXJ5ID0gYFxuICAgICAgU0VMRUNUIFxuICAgICAgICBzLiosXG4gICAgICAgIENPQUxFU0NFKGEubmFtZSwgJ0F0YW5tYWTEsScpIGFzIGFkdmlzb3JfbmFtZSxcbiAgICAgICAgYS5lbWFpbCBhcyBhZHZpc29yX2VtYWlsXG4gICAgICBGUk9NIHN0dWRlbnRzIHNcbiAgICAgIExFRlQgSk9JTiBhZHZpc29ycyBhIE9OIHMuYWR2aXNvcl9lbWFpbCA9IGEuZW1haWxcbiAgICAgIE9SREVSIEJZIHMuY3JlYXRlZF9hdCBERVNDXG4gICAgYDtcbiAgICBcbiAgICBsb2dnZXIuaW5mbygnZ2V0QWxsU3R1ZGVudHM6IFNRTCBzb3JndXN1IGhhesSxcmxhbmTEsTonLCBxdWVyeSk7XG4gICAgXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KHF1ZXJ5KTtcbiAgICBsb2dnZXIuaW5mbygnZ2V0QWxsU3R1ZGVudHM6IFNvcmd1IHNvbnVjdTonLCB7IFxuICAgICAgcm93Q291bnQ6IHJlc3VsdC5yb3dDb3VudCxcbiAgICAgIHJvd3M6IHJlc3VsdC5yb3dzIFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ2dldEFsbFN0dWRlbnRzIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gICAgbG9nZ2VyLmluZm8oJ2dldEFsbFN0dWRlbnRzOiBWZXJpdGFiYW7EsSBiYcSfbGFudMSxc8SxIGthcGF0xLFsZMSxJyk7XG4gIH1cbn1cblxuLy8gw5bEn3JlbmNpIHByb2ZpbGluaSBnw7xuY2VsbGVcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVTdHVkZW50UHJvZmlsZShlbWFpbDogc3RyaW5nLCBkYXRhOiBQYXJ0aWFsPEN1c3RvbWVyUmVjb3JkPikge1xuICBsZXQgY2xpZW50O1xuICB0cnkge1xuICAgIGNsaWVudCA9IGF3YWl0IHBvb2wuY29ubmVjdCgpO1xuICAgIFxuICAgIC8vIEfDvG5jZWxsZW5lYmlsaXIgYWxhbmxhcsSxIGJlbGlybGVcbiAgICBjb25zdCB1cGRhdGVGaWVsZHMgPSBbXG4gICAgICAnbmFtZScsICdwaG9uZScsICdiaXJ0aF9kYXRlJywgJ2JpcnRoX3BsYWNlJywgJ21hcml0YWxfc3RhdHVzJyxcbiAgICAgICdjb250YWN0X2FkZHJlc3MnLCAncGFzc3BvcnRfbnVtYmVyJywgJ3Bhc3Nwb3J0X3R5cGUnLFxuICAgICAgJ3Bhc3Nwb3J0X2lzc3VlX2RhdGUnLCAncGFzc3BvcnRfZXhwaXJ5X2RhdGUnLCAnaXNzdWluZ19hdXRob3JpdHknLFxuICAgICAgJ2hpZ2hfc2Nob29sX25hbWUnLCAnaGlnaF9zY2hvb2xfdHlwZScsICdoaWdoX3NjaG9vbF9jaXR5JyxcbiAgICAgICdoaWdoX3NjaG9vbF9zdGFydF9kYXRlJywgJ2hpZ2hfc2Nob29sX2dyYWR1YXRpb25fZGF0ZScsXG4gICAgICAndW5pdmVyc2l0eV9uYW1lJywgJ3VuaXZlcnNpdHlfZGVwYXJ0bWVudCcsICd1bml2ZXJzaXR5X3N0YXJ0X2RhdGUnLFxuICAgICAgJ3VuaXZlcnNpdHlfZW5kX2RhdGUnLCAnZ3JhZHVhdGlvbl9zdGF0dXMnLCAnZ3JhZHVhdGlvbl95ZWFyJyxcbiAgICAgICd1bml2ZXJzaXR5X3ByZWZlcmVuY2VzJywgJ2dlcm1hbl9kZXBhcnRtZW50X3ByZWZlcmVuY2UnLFxuICAgICAgJ2xhbmd1YWdlX2xldmVsJywgJ2xhbmd1YWdlX2NlcnRpZmljYXRlJywgJ2xhbmd1YWdlX2NvdXJzZV9yZWdpc3RyYXRpb24nLFxuICAgICAgJ2xhbmd1YWdlX2xlYXJuaW5nX3N0YXR1cycsICd2aXNhX2NvbnN1bGF0ZScsICd2aXNhX2FwcGxpY2F0aW9uX2RhdGUnLFxuICAgICAgJ3Zpc2FfYXBwb2ludG1lbnRfZGF0ZScsICd2aXNhX2RvY3VtZW50JywgJ2ZpbmFuY2lhbF9wcm9vZicsXG4gICAgICAnZmluYW5jaWFsX3Byb29mX3N0YXR1cycsICdleGFtX2VudHJ5JywgJ2V4YW1fcmVzdWx0X2RhdGUnLFxuICAgICAgJ21vdGhlcl9uYW1lJywgJ21vdGhlcl9zdXJuYW1lJywgJ21vdGhlcl9iaXJ0aF9kYXRlJyxcbiAgICAgICdtb3RoZXJfYmlydGhfcGxhY2UnLCAnbW90aGVyX3Jlc2lkZW5jZScsICdtb3RoZXJfcGhvbmUnLFxuICAgICAgJ2ZhdGhlcl9uYW1lJywgJ2ZhdGhlcl9zdXJuYW1lJywgJ2ZhdGhlcl9iaXJ0aF9kYXRlJyxcbiAgICAgICdmYXRoZXJfYmlydGhfcGxhY2UnLCAnZmF0aGVyX3Jlc2lkZW5jZScsICdmYXRoZXJfcGhvbmUnXG4gICAgXSBhcyBjb25zdDtcblxuICAgIC8vIEfDvG5jZWxsZW5lY2VrIGFsYW5sYXLEsSB2ZSBkZcSfZXJsZXJpIGhhesSxcmxhXG4gICAgY29uc3QgdXBkYXRlczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCB2YWx1ZXM6IGFueVtdID0gW107XG4gICAgbGV0IHBhcmFtSW5kZXggPSAxO1xuXG4gICAgZm9yIChjb25zdCBmaWVsZCBvZiB1cGRhdGVGaWVsZHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtmaWVsZCBhcyBrZXlvZiB0eXBlb2YgZGF0YV07XG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB1cGRhdGVzLnB1c2goYCR7ZmllbGR9ID0gJCR7cGFyYW1JbmRleH1gKTtcbiAgICAgICAgdmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICBwYXJhbUluZGV4Kys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHVwZGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0fDvG5jZWxsZW5lY2VrIGFsYW4gYnVsdW5hbWFkxLEnKTtcbiAgICB9XG5cbiAgICAvLyB1cGRhdGVkX2F0IGFsYW7EsW7EsSBla2xlXG4gICAgdXBkYXRlcy5wdXNoKGB1cGRhdGVkX2F0ID0gTk9XKClgKTtcbiAgICB2YWx1ZXMucHVzaChlbWFpbCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFVQREFURSBzdHVkZW50cyBcbiAgICAgIFNFVCAke3VwZGF0ZXMuam9pbignLCAnKX1cbiAgICAgIFdIRVJFIGVtYWlsID0gJCR7cGFyYW1JbmRleH1cbiAgICAgIFJFVFVSTklORyAqXG4gICAgYDtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeShxdWVyeSwgdmFsdWVzKTtcbiAgICBcbiAgICBpZiAocmVzdWx0LnJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ8OWxJ9yZW5jaSBidWx1bmFtYWTEsScpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ8OWxJ9yZW5jaSBwcm9maWwgZ8O8bmNlbGxlbWUgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKGNsaWVudCkge1xuICAgICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gw5bEn3JlbmNpIGJlbGdlc2kgZWtsZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZFN0dWRlbnREb2N1bWVudChlbWFpbDogc3RyaW5nLCBkb2N1bWVudDoge1xuICBkb2N1bWVudFR5cGU6IHN0cmluZztcbiAgZG9jdW1lbnROYW1lOiBzdHJpbmc7XG4gIGRvY3VtZW50VXJsOiBzdHJpbmc7XG59KSB7XG4gIGxldCBjbGllbnQ7XG4gIHRyeSB7XG4gICAgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gICAgXG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBkb2N1bWVudHMgKFxuICAgICAgICBzdHVkZW50X2VtYWlsLFxuICAgICAgICBkb2N1bWVudF90eXBlLFxuICAgICAgICBmaWxlX25hbWUsXG4gICAgICAgIGZpbGVfcGF0aCxcbiAgICAgICAgdXBsb2FkX2RhdGUsXG4gICAgICAgIHN0YXR1c1xuICAgICAgKSBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCBOT1coKSwgJ3BlbmRpbmcnKVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuXG4gICAgY29uc3QgdmFsdWVzID0gW1xuICAgICAgZW1haWwsXG4gICAgICBkb2N1bWVudC5kb2N1bWVudFR5cGUsXG4gICAgICBkb2N1bWVudC5kb2N1bWVudE5hbWUsXG4gICAgICBkb2N1bWVudC5kb2N1bWVudFVybFxuICAgIF07XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkocXVlcnksIHZhbHVlcyk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignQmVsZ2UgZWtsZW1lIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChjbGllbnQpIHtcbiAgICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gICAgfVxuICB9XG59XG5cbi8vIMOWxJ9yZW5jaSBiZWxnZXNpbmkgZ8O8bmNlbGxlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU3R1ZGVudERvY3VtZW50KGRvY3VtZW50SWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmcpIHtcbiAgbGV0IGNsaWVudDtcbiAgdHJ5IHtcbiAgICBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgICBcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFVQREFURSBkb2N1bWVudHMgXG4gICAgICBTRVQgc3RhdHVzID0gJDEsIHVwZGF0ZWRfYXQgPSBOT1coKVxuICAgICAgV0hFUkUgaWQgPSAkMlxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KHF1ZXJ5LCBbc3RhdHVzLCBkb2N1bWVudElkXSk7XG4gICAgXG4gICAgaWYgKHJlc3VsdC5yb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdCZWxnZSBidWx1bmFtYWTEsScpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0JlbGdlIGfDvG5jZWxsZW1lIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChjbGllbnQpIHtcbiAgICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gICAgfVxuICB9XG59XG5cbi8vIMOWxJ9yZW5jaSBzw7xyZWNpbmkgYmHFn2xhdFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0U3R1ZGVudFByb2Nlc3MoZW1haWw6IHN0cmluZywgYWR2aXNvckVtYWlsOiBzdHJpbmcpIHtcbiAgbGV0IGNsaWVudDtcbiAgdHJ5IHtcbiAgICBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgICBcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIFVQREFURSBzdHVkZW50cyBcbiAgICAgIFNFVCBcbiAgICAgICAgcHJvY2Vzc19zdGFydGVkID0gdHJ1ZSxcbiAgICAgICAgcHJvY2Vzc19zdGFydF9kYXRlID0gTk9XKCksXG4gICAgICAgIHN0YWdlID0gJ1PDvHJlw6cgQmHFn2xhdMSxbGTEsScsXG4gICAgICAgIGFkdmlzb3JfZW1haWwgPSAkMSxcbiAgICAgICAgdXBkYXRlZF9hdCA9IE5PVygpXG4gICAgICBXSEVSRSBlbWFpbCA9ICQyXG4gICAgICBSRVRVUk5JTkcgKlxuICAgIGA7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkocXVlcnksIFthZHZpc29yRW1haWwsIGVtYWlsXSk7XG4gICAgXG4gICAgaWYgKHJlc3VsdC5yb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfDlsSfcmVuY2kgYnVsdW5hbWFkxLEnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCfDlsSfcmVuY2kgc8O8cmXDpyBiYcWfbGF0bWEgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKGNsaWVudCkge1xuICAgICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gWWVuaSDDtsSfcmVuY2kgb2x1xZ90dXJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTdHVkZW50KGRhdGE6IFBhcnRpYWw8Q3VzdG9tZXJSZWNvcmQ+KSB7XG4gIGxldCBjbGllbnQ7XG4gIHRyeSB7XG4gICAgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gICAgXG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBzdHVkZW50cyAoXG4gICAgICAgIGVtYWlsLFxuICAgICAgICBuYW1lLFxuICAgICAgICBwaG9uZSxcbiAgICAgICAgc3RhZ2UsXG4gICAgICAgIHByb2Nlc3Nfc3RhcnRlZCxcbiAgICAgICAgY3JlYXRlZF9hdCxcbiAgICAgICAgdXBkYXRlZF9hdCxcbiAgICAgICAgYWR2aXNvcl9pZCxcbiAgICAgICAgYWR2aXNvcl9uYW1lLFxuICAgICAgICBhZHZpc29yX2VtYWlsXG4gICAgICApIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1LCBOT1coKSwgTk9XKCksICQ2LCAkNywgJDgpXG4gICAgICBSRVRVUk5JTkcgKlxuICAgIGA7XG5cbiAgICBjb25zdCB2YWx1ZXMgPSBbXG4gICAgICBkYXRhLmVtYWlsLFxuICAgICAgZGF0YS5uYW1lLFxuICAgICAgZGF0YS5waG9uZSB8fCAnJyxcbiAgICAgIGRhdGEuc3RhZ2UgfHwgJ25ldycsXG4gICAgICBkYXRhLnByb2Nlc3Nfc3RhcnRlZCB8fCBmYWxzZSxcbiAgICAgIGRhdGEuYWR2aXNvcl9pZCB8fCBudWxsLFxuICAgICAgZGF0YS5hZHZpc29yX25hbWUgfHwgbnVsbCxcbiAgICAgIGRhdGEuYWR2aXNvcl9lbWFpbCB8fCBudWxsXG4gICAgXTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeShxdWVyeSwgdmFsdWVzKTtcbiAgICBsb2dnZXIuaW5mbygnWWVuaSDDtsSfcmVuY2kgb2x1xZ90dXJ1bGR1OicsIHsgZW1haWw6IGRhdGEuZW1haWwgfSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignw5bEn3JlbmNpIG9sdcWfdHVybWEgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKGNsaWVudCkge1xuICAgICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gVmVyaXRhYmFuxLEgdGFibG9sYXLEsW7EsSBvbHXFn3R1clxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRhYmxlcygpIHtcbiAgbGV0IGNsaWVudDtcbiAgdHJ5IHtcbiAgICBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgICBcbiAgICAvLyDDlsSfcmVuY2lsZXIgdGFibG9zdVxuICAgIGF3YWl0IGNsaWVudC5xdWVyeShgXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBzdHVkZW50cyAoXG4gICAgICAgIGlkIFNFUklBTCBQUklNQVJZIEtFWSxcbiAgICAgICAgZW1haWwgVkFSQ0hBUigyNTUpIFVOSVFVRSBOT1QgTlVMTCxcbiAgICAgICAgbmFtZSBWQVJDSEFSKDI1NSksXG4gICAgICAgIHBob25lIFZBUkNIQVIoNTApLFxuICAgICAgICBzdGFnZSBWQVJDSEFSKDEwMCkgREVGQVVMVCAnbmV3JyxcbiAgICAgICAgcHJvY2Vzc19zdGFydGVkIEJPT0xFQU4gREVGQVVMVCBGQUxTRSxcbiAgICAgICAgcHJvY2Vzc19zdGFydF9kYXRlIFRJTUVTVEFNUCBXSVRIIFRJTUUgWk9ORSxcbiAgICAgICAgY3JlYXRlZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgdXBkYXRlZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgYWR2aXNvcl9pZCBJTlRFR0VSIFJFRkVSRU5DRVMgYWR2aXNvcnMoaWQpLFxuICAgICAgICBhZHZpc29yX25hbWUgVkFSQ0hBUigyNTUpLFxuICAgICAgICBhZHZpc29yX2VtYWlsIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgc2FsZXNfaWQgVkFSQ0hBUigyNTUpLFxuICAgICAgICBzYWxlc19uYW1lIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgc2FsZXNfZW1haWwgVkFSQ0hBUigyNTUpLFxuICAgICAgICBsZWFkX2lkIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgY29udGFjdF9hZGRyZXNzIFRFWFQsXG4gICAgICAgIGFnZSBJTlRFR0VSLFxuICAgICAgICBiaXJ0aF9kYXRlIERBVEUsXG4gICAgICAgIGJpcnRoX3BsYWNlIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgbWFyaXRhbF9zdGF0dXMgVkFSQ0hBUig1MCksXG4gICAgICAgIHBhc3Nwb3J0X251bWJlciBWQVJDSEFSKDUwKSxcbiAgICAgICAgcGFzc3BvcnRfdHlwZSBWQVJDSEFSKDEwMCksXG4gICAgICAgIHBhc3Nwb3J0X2lzc3VlX2RhdGUgREFURSxcbiAgICAgICAgcGFzc3BvcnRfZXhwaXJ5X2RhdGUgREFURSxcbiAgICAgICAgaXNzdWluZ19hdXRob3JpdHkgVkFSQ0hBUigyNTUpLFxuICAgICAgICBwbnJfbnVtYmVyIFZBUkNIQVIoNTApLFxuICAgICAgICB2aXNhX2FwcGxpY2F0aW9uX2RhdGUgREFURSxcbiAgICAgICAgdmlzYV9hcHBvaW50bWVudF9kYXRlIERBVEUsXG4gICAgICAgIHZpc2FfZG9jdW1lbnQgVkFSQ0hBUigyNTUpLFxuICAgICAgICB2aXNhX2NvbnN1bGF0ZSBWQVJDSEFSKDI1NSksXG4gICAgICAgIGhhc19iZWVuX3RvX2dlcm1hbnkgQk9PTEVBTiBERUZBVUxUIEZBTFNFLFxuICAgICAgICBoaWdoX3NjaG9vbF9uYW1lIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgaGlnaF9zY2hvb2xfdHlwZSBWQVJDSEFSKDEwMCksXG4gICAgICAgIGhpZ2hfc2Nob29sX2NpdHkgVkFSQ0hBUigyNTUpLFxuICAgICAgICBoaWdoX3NjaG9vbF9zdGFydF9kYXRlIERBVEUsXG4gICAgICAgIGhpZ2hfc2Nob29sX2dyYWR1YXRpb25fZGF0ZSBEQVRFLFxuICAgICAgICB1bml2ZXJzaXR5X25hbWUgVkFSQ0hBUigyNTUpLFxuICAgICAgICB1bml2ZXJzaXR5X2RlcGFydG1lbnQgVkFSQ0hBUigyNTUpLFxuICAgICAgICB1bml2ZXJzaXR5X3N0YXJ0X2RhdGUgREFURSxcbiAgICAgICAgdW5pdmVyc2l0eV9lbmRfZGF0ZSBEQVRFLFxuICAgICAgICBncmFkdWF0aW9uX3N0YXR1cyBWQVJDSEFSKDUwKSxcbiAgICAgICAgZ3JhZHVhdGlvbl95ZWFyIElOVEVHRVIsXG4gICAgICAgIHVuaXZlcnNpdHlfcHJlZmVyZW5jZXMgVEVYVFtdLFxuICAgICAgICBnZXJtYW5fZGVwYXJ0bWVudF9wcmVmZXJlbmNlIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgbGFuZ3VhZ2VfbGV2ZWwgVkFSQ0hBUig1MCksXG4gICAgICAgIGxhbmd1YWdlX2NlcnRpZmljYXRlIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgbGFuZ3VhZ2VfY291cnNlX3JlZ2lzdHJhdGlvbiBWQVJDSEFSKDI1NSksXG4gICAgICAgIGxhbmd1YWdlX2xlYXJuaW5nX3N0YXR1cyBWQVJDSEFSKDUwKSxcbiAgICAgICAgZmluYW5jaWFsX3Byb29mIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgZmluYW5jaWFsX3Byb29mX3N0YXR1cyBWQVJDSEFSKDUwKSxcbiAgICAgICAgZXhhbV9lbnRyeSBCT09MRUFOIERFRkFVTFQgRkFMU0UsXG4gICAgICAgIGV4YW1fcmVzdWx0X2RhdGUgREFURSxcbiAgICAgICAgbW90aGVyX25hbWUgVkFSQ0hBUigyNTUpLFxuICAgICAgICBtb3RoZXJfc3VybmFtZSBWQVJDSEFSKDI1NSksXG4gICAgICAgIG1vdGhlcl9iaXJ0aF9kYXRlIERBVEUsXG4gICAgICAgIG1vdGhlcl9iaXJ0aF9wbGFjZSBWQVJDSEFSKDI1NSksXG4gICAgICAgIG1vdGhlcl9yZXNpZGVuY2UgVkFSQ0hBUigyNTUpLFxuICAgICAgICBtb3RoZXJfcGhvbmUgVkFSQ0hBUig1MCksXG4gICAgICAgIGZhdGhlcl9uYW1lIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgZmF0aGVyX3N1cm5hbWUgVkFSQ0hBUigyNTUpLFxuICAgICAgICBmYXRoZXJfYmlydGhfZGF0ZSBEQVRFLFxuICAgICAgICBmYXRoZXJfYmlydGhfcGxhY2UgVkFSQ0hBUigyNTUpLFxuICAgICAgICBmYXRoZXJfcmVzaWRlbmNlIFZBUkNIQVIoMjU1KSxcbiAgICAgICAgZmF0aGVyX3Bob25lIFZBUkNIQVIoNTApLFxuICAgICAgICB3ZWJob29rX3VwZGF0ZWQgQk9PTEVBTiBERUZBVUxUIEZBTFNFLFxuICAgICAgICB3ZWJob29rX3VwZGF0ZV90aW1lc3RhbXAgVElNRVNUQU1QIFdJVEggVElNRSBaT05FXG4gICAgICApO1xuICAgIGApO1xuXG4gICAgLy8gRGFuxLHFn21hbmxhciB0YWJsb3N1XG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KGBcbiAgICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIGFkdmlzb3JzIChcbiAgICAgICAgaWQgU0VSSUFMIFBSSU1BUlkgS0VZLFxuICAgICAgICBlbWFpbCBWQVJDSEFSKDI1NSkgVU5JUVVFIE5PVCBOVUxMLFxuICAgICAgICBuYW1lIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcbiAgICAgICAgY3JlYXRlZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcbiAgICAgICAgdXBkYXRlZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUFxuICAgICAgKTtcbiAgICBgKTtcblxuICAgIC8vIE1lc2FqbGFyIHRhYmxvc3VcbiAgICBhd2FpdCBjbGllbnQucXVlcnkoYFxuICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgbWVzc2FnZXMgKFxuICAgICAgICBpZCBTRVJJQUwgUFJJTUFSWSBLRVksXG4gICAgICAgIHNlbmRlcl9lbWFpbCBWQVJDSEFSKDI1NSkgTk9UIE5VTEwsXG4gICAgICAgIHJlY2VpdmVyX2VtYWlsIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcbiAgICAgICAgc2VuZGVyX3JvbGUgVkFSQ0hBUig1MCkgTk9UIE5VTEwsXG4gICAgICAgIGNvbnRlbnQgVEVYVCBOT1QgTlVMTCxcbiAgICAgICAgc3ViamVjdCBWQVJDSEFSKDI1NSksXG4gICAgICAgIGNhdGVnb3J5IFZBUkNIQVIoNTApIERFRkFVTFQgJ2dlbmVyYWwnLFxuICAgICAgICByZXBseV90b19pZCBJTlRFR0VSIFJFRkVSRU5DRVMgbWVzc2FnZXMoaWQpLFxuICAgICAgICBjcmVhdGVkX2F0IFRJTUVTVEFNUCBXSVRIIFRJTUUgWk9ORSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLFxuICAgICAgICBpc19yZWFkIEJPT0xFQU4gREVGQVVMVCBGQUxTRSxcbiAgICAgICAgQ09OU1RSQUlOVCB2YWxpZF9zZW5kZXJfcm9sZSBDSEVDSyAoc2VuZGVyX3JvbGUgSU4gKCdzdHVkZW50JywgJ2Fkdmlzb3InKSlcbiAgICAgICk7XG4gICAgYCk7XG5cbiAgICBsb2dnZXIuaW5mbygnVmVyaXRhYmFuxLEgdGFibG9sYXLEsSBiYcWfYXLEsXlsYSBvbHXFn3R1cnVsZHUnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ1Zlcml0YWJhbsSxIHRhYmxvbGFyxLEgb2x1xZ90dXJtYSBoYXRhc8SxOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAoY2xpZW50KSB7XG4gICAgICBjbGllbnQucmVsZWFzZSgpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBVeWd1bGFtYSBiYcWfbGFkxLHEn8SxbmRhIHRhYmxvbGFyxLEgb2x1xZ90dXJcbmNyZWF0ZVRhYmxlcygpLmNhdGNoKGVycm9yID0+IHtcbiAgbG9nZ2VyLmVycm9yKCdUYWJsb2xhciBvbHXFn3R1cnVsdXJrZW4gaGF0YTonLCBlcnJvcik7XG4gIHByb2Nlc3MuZXhpdCgxKTtcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBwb29sOyBcblxuLy8gTWVzYWogacWfbGVtbGVyaVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2UoZGF0YToge1xuICBzZW5kZXJFbWFpbDogc3RyaW5nO1xuICByZWNlaXZlckVtYWlsOiBzdHJpbmc7XG4gIHNlbmRlclJvbGU6ICdzdHVkZW50JyB8ICdhZHZpc29yJztcbiAgY29udGVudDogc3RyaW5nO1xuICBzdWJqZWN0Pzogc3RyaW5nO1xuICBjYXRlZ29yeT86IHN0cmluZztcbiAgcmVwbHlUb0lkPzogbnVtYmVyO1xufSkge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICBgSU5TRVJUIElOVE8gbWVzc2FnZXMgKHNlbmRlcl9lbWFpbCwgcmVjZWl2ZXJfZW1haWwsIHNlbmRlcl9yb2xlLCBjb250ZW50LCBzdWJqZWN0LCBjYXRlZ29yeSwgcmVwbHlfdG9faWQsIGNyZWF0ZWRfYXQpIFxuICAgICAgIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgJDcsIE5PVygpKSBcbiAgICAgICBSRVRVUk5JTkcgKmAsXG4gICAgICBbXG4gICAgICAgIGRhdGEuc2VuZGVyRW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgZGF0YS5yZWNlaXZlckVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgIGRhdGEuc2VuZGVyUm9sZSxcbiAgICAgICAgZGF0YS5jb250ZW50LFxuICAgICAgICBkYXRhLnN1YmplY3QgfHwgbnVsbCxcbiAgICAgICAgZGF0YS5jYXRlZ29yeSB8fCAnZ2VuZXJhbCcsXG4gICAgICAgIGRhdGEucmVwbHlUb0lkIHx8IG51bGxcbiAgICAgIF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ01lc2FqIG9sdcWfdHVybWEgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWVzc2FnZXNCeVVzZXIoZW1haWw6IHN0cmluZykge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICBgU0VMRUNUICogRlJPTSBtZXNzYWdlcyBcbiAgICAgICBXSEVSRSBzZW5kZXJfZW1haWwgPSAkMSBPUiByZWNlaXZlcl9lbWFpbCA9ICQxIFxuICAgICAgIE9SREVSIEJZIGNyZWF0ZWRfYXQgREVTQ2AsXG4gICAgICBbZW1haWwudG9Mb3dlckNhc2UoKV1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dnZXIuZXJyb3IoJ0t1bGxhbsSxY8SxIG1lc2FqbGFyxLEgZ2V0aXJtZSBoYXRhc8SxOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBmaW5hbGx5IHtcbiAgICBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb252ZXJzYXRpb25zQnlVc2VyKGVtYWlsOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgLy8gS3VsbGFuxLFjxLFuxLFuIGthdMSxbGTEscSfxLEgdMO8bSBrb251xZ9tYWxhcsSxIGdldGlyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgYFNFTEVDVCBESVNUSU5DVCBcbiAgICAgICAgIENBU0UgXG4gICAgICAgICAgIFdIRU4gc2VuZGVyX2VtYWlsID0gJDEgVEhFTiByZWNlaXZlcl9lbWFpbCBcbiAgICAgICAgICAgRUxTRSBzZW5kZXJfZW1haWwgXG4gICAgICAgICBFTkQgYXMgb3RoZXJfcGFydGljaXBhbnQsXG4gICAgICAgICBNSU4oY3JlYXRlZF9hdCkgYXMgZmlyc3RfbWVzc2FnZSxcbiAgICAgICAgIE1BWChjcmVhdGVkX2F0KSBhcyBsYXN0X21lc3NhZ2UsXG4gICAgICAgICBDT1VOVCgqKSBhcyBtZXNzYWdlX2NvdW50LFxuICAgICAgICAgU1VNKENBU0UgV0hFTiBpc19yZWFkID0gZmFsc2UgQU5EIHJlY2VpdmVyX2VtYWlsID0gJDEgVEhFTiAxIEVMU0UgMCBFTkQpIGFzIHVucmVhZF9jb3VudFxuICAgICAgIEZST00gbWVzc2FnZXMgXG4gICAgICAgV0hFUkUgc2VuZGVyX2VtYWlsID0gJDEgT1IgcmVjZWl2ZXJfZW1haWwgPSAkMSBcbiAgICAgICBHUk9VUCBCWSBvdGhlcl9wYXJ0aWNpcGFudFxuICAgICAgIE9SREVSIEJZIGxhc3RfbWVzc2FnZSBERVNDYCxcbiAgICAgIFtlbWFpbC50b0xvd2VyQ2FzZSgpXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignS3VsbGFuxLFjxLEga29udcWfbWFsYXLEsSBnZXRpcm1lIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE1lc3NhZ2VzQmV0d2VlblVzZXJzKHVzZXIxOiBzdHJpbmcsIHVzZXIyOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgYFNFTEVDVCAqIEZST00gbWVzc2FnZXMgXG4gICAgICAgV0hFUkUgKHNlbmRlcl9lbWFpbCA9ICQxIEFORCByZWNlaXZlcl9lbWFpbCA9ICQyKSBcbiAgICAgICAgICBPUiAoc2VuZGVyX2VtYWlsID0gJDIgQU5EIHJlY2VpdmVyX2VtYWlsID0gJDEpIFxuICAgICAgIE9SREVSIEJZIGNyZWF0ZWRfYXQgQVNDYCxcbiAgICAgIFt1c2VyMS50b0xvd2VyQ2FzZSgpLCB1c2VyMi50b0xvd2VyQ2FzZSgpXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignxLBraSBrdWxsYW7EsWPEsSBhcmFzxLEgbWVzYWpsYXIgZ2V0aXJtZSBoYXRhc8SxOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSBmaW5hbGx5IHtcbiAgICBjbGllbnQucmVsZWFzZSgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtYXJrTWVzc2FnZUFzUmVhZChtZXNzYWdlSWQ6IG51bWJlcikge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjbGllbnQucXVlcnkoXG4gICAgICAnVVBEQVRFIG1lc3NhZ2VzIFNFVCBpc19yZWFkID0gdHJ1ZSBXSEVSRSBpZCA9ICQxIFJFVFVSTklORyAqJyxcbiAgICAgIFttZXNzYWdlSWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdNZXNhaiBva3VuZHUgacWfYXJldGxlbWUgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH0gZmluYWxseSB7XG4gICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VW5yZWFkTWVzc2FnZUNvdW50KGVtYWlsOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgcG9vbC5jb25uZWN0KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCBDT1VOVCgqKSBhcyBjb3VudCBGUk9NIG1lc3NhZ2VzIFdIRVJFIHJlY2VpdmVyX2VtYWlsID0gJDEgQU5EIGlzX3JlYWQgPSBmYWxzZScsXG4gICAgICBbZW1haWwudG9Mb3dlckNhc2UoKV1cbiAgICApO1xuICAgIHJldHVybiBwYXJzZUludChyZXN1bHQucm93c1swXS5jb3VudCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdPa3VubWFtxLHFnyBtZXNhaiBzYXnEsXPEsSBnZXRpcm1lIGhhdGFzxLE6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKCk7XG4gIH1cbn0gIl0sIm5hbWVzIjpbIlBvb2wiLCJsb2dnZXIiLCJwcm9jZXNzIiwiZW52IiwiUE9TVEdSRVNfUEFTU1dPUkQiLCJFcnJvciIsInBvb2wiLCJ1c2VyIiwiUE9TVEdSRVNfVVNFUiIsImhvc3QiLCJQT1NUR1JFU19IT1NUIiwiZGF0YWJhc2UiLCJQT1NUR1JFU19EQVRBQkFTRSIsInBhc3N3b3JkIiwicG9ydCIsInBhcnNlSW50IiwiUE9TVEdSRVNfUE9SVCIsInNzbCIsIm9uIiwiaW5mbyIsImVyciIsImVycm9yIiwiZ2V0U3R1ZGVudEJ5RW1haWwiLCJlbWFpbCIsImNsaWVudCIsImNvbm5lY3QiLCJyZXN1bHQiLCJxdWVyeSIsInJvd3MiLCJyZWxlYXNlIiwiZ2V0QWR2aXNvckJ5RW1haWwiLCJnZXRTdHVkZW50c0J5QWR2aXNvciIsImFkdmlzb3JFbWFpbCIsInVwZGF0ZVN0dWRlbnRQcm9jZXNzIiwicHJvY2Vzc1N0YXJ0ZWQiLCJ1cGRhdGVTdHVkZW50U3RhZ2UiLCJzdGFnZSIsInNhdmVEb2N1bWVudCIsInN0dWRlbnRJZCIsImRvY3VtZW50VHlwZSIsImZpbGVQYXRoIiwiZmlsZU5hbWUiLCJnZXREb2N1bWVudHNCeVN0dWRlbnRJZCIsImdldEFsbFN0dWRlbnRzIiwicm93Q291bnQiLCJ1cGRhdGVTdHVkZW50UHJvZmlsZSIsImRhdGEiLCJ1cGRhdGVGaWVsZHMiLCJ1cGRhdGVzIiwidmFsdWVzIiwicGFyYW1JbmRleCIsImZpZWxkIiwidmFsdWUiLCJ1bmRlZmluZWQiLCJwdXNoIiwibGVuZ3RoIiwiam9pbiIsImFkZFN0dWRlbnREb2N1bWVudCIsImRvY3VtZW50IiwiZG9jdW1lbnROYW1lIiwiZG9jdW1lbnRVcmwiLCJ1cGRhdGVTdHVkZW50RG9jdW1lbnQiLCJkb2N1bWVudElkIiwic3RhdHVzIiwic3RhcnRTdHVkZW50UHJvY2VzcyIsImNyZWF0ZVN0dWRlbnQiLCJuYW1lIiwicGhvbmUiLCJwcm9jZXNzX3N0YXJ0ZWQiLCJhZHZpc29yX2lkIiwiYWR2aXNvcl9uYW1lIiwiYWR2aXNvcl9lbWFpbCIsImNyZWF0ZVRhYmxlcyIsImNhdGNoIiwiZXhpdCIsImNyZWF0ZU1lc3NhZ2UiLCJzZW5kZXJFbWFpbCIsInRvTG93ZXJDYXNlIiwicmVjZWl2ZXJFbWFpbCIsInNlbmRlclJvbGUiLCJjb250ZW50Iiwic3ViamVjdCIsImNhdGVnb3J5IiwicmVwbHlUb0lkIiwiZ2V0TWVzc2FnZXNCeVVzZXIiLCJnZXRDb252ZXJzYXRpb25zQnlVc2VyIiwiZ2V0TWVzc2FnZXNCZXR3ZWVuVXNlcnMiLCJ1c2VyMSIsInVzZXIyIiwibWFya01lc3NhZ2VBc1JlYWQiLCJtZXNzYWdlSWQiLCJnZXRVbnJlYWRNZXNzYWdlQ291bnQiLCJjb3VudCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/utils/logger.ts":
/*!*****************************!*\
  !*** ./src/utils/logger.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logError: () => (/* binding */ logError),\n/* harmony export */   logInfo: () => (/* binding */ logInfo),\n/* harmony export */   logWebhook: () => (/* binding */ logWebhook),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n// Basit bir logger implementasyonu\nconst logger = {\n    info: (...args)=>{\n        if (true) {\n            console.log('[INFO]', ...args);\n        }\n    },\n    error: (...args)=>{\n        if (true) {\n            console.error('[ERROR]', ...args);\n        }\n    },\n    warn: (...args)=>{\n        if (true) {\n            console.warn('[WARN]', ...args);\n        }\n    },\n    debug: (...args)=>{\n        if (true) {\n            console.debug('[DEBUG]', ...args);\n        }\n    }\n};\n/**\n * Hata logu\n * \n * @param message - Hata mesajı\n * @param error - Hata nesnesi veya ek bilgi\n */ const logError = (message, error)=>{\n    logger.error(message, error);\n};\n/**\n * Bilgi logu\n * \n * @param message - Bilgi mesajı\n * @param data - Ek veri\n */ const logInfo = (message, data)=>{\n    logger.info(message, data);\n};\n/**\n * Webhook isteği logu\n * \n * @param source - Webhook kaynağı\n * @param status - İşlem durumu\n * @param data - İstek verisi\n */ const logWebhook = (source, status, data)=>{\n    const message = `Webhook alındı: ${source} - Durum: ${status}`;\n    if (status === 'error') {\n        logger.error(message, data);\n    } else {\n        logger.info(message, data);\n    }\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvdXRpbHMvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxtQ0FBbUM7QUFDbkMsTUFBTUEsU0FBUztJQUNiQyxNQUFNLENBQUMsR0FBR0M7UUFDUixJQUFJQyxJQUFzQyxFQUFFO1lBQzFDQyxRQUFRQyxHQUFHLENBQUMsYUFBYUg7UUFDM0I7SUFDRjtJQUNBSSxPQUFPLENBQUMsR0FBR0o7UUFDVCxJQUFJQyxJQUFzQyxFQUFFO1lBQzFDQyxRQUFRRSxLQUFLLENBQUMsY0FBY0o7UUFDOUI7SUFDRjtJQUNBSyxNQUFNLENBQUMsR0FBR0w7UUFDUixJQUFJQyxJQUFzQyxFQUFFO1lBQzFDQyxRQUFRRyxJQUFJLENBQUMsYUFBYUw7UUFDNUI7SUFDRjtJQUNBTSxPQUFPLENBQUMsR0FBR047UUFDVCxJQUFJQyxJQUFzQyxFQUFFO1lBQzFDQyxRQUFRSSxLQUFLLENBQUMsY0FBY047UUFDOUI7SUFDRjtBQUNGO0FBRUE7Ozs7O0NBS0MsR0FDTSxNQUFNTyxXQUFXLENBQUNDLFNBQWlCSjtJQUN4Q04sT0FBT00sS0FBSyxDQUFDSSxTQUFTSjtBQUN4QixFQUFFO0FBRUY7Ozs7O0NBS0MsR0FDTSxNQUFNSyxVQUFVLENBQUNELFNBQWlCRTtJQUN2Q1osT0FBT0MsSUFBSSxDQUFDUyxTQUFTRTtBQUN2QixFQUFFO0FBRUY7Ozs7OztDQU1DLEdBQ00sTUFBTUMsYUFBYSxDQUFDQyxRQUFnQkMsUUFBNkJIO0lBQ3RFLE1BQU1GLFVBQVUsQ0FBQyxnQkFBZ0IsRUFBRUksT0FBTyxVQUFVLEVBQUVDLFFBQVE7SUFDOUQsSUFBSUEsV0FBVyxTQUFTO1FBQ3RCZixPQUFPTSxLQUFLLENBQUNJLFNBQVNFO0lBQ3hCLE9BQU87UUFDTFosT0FBT0MsSUFBSSxDQUFDUyxTQUFTRTtJQUN2QjtBQUNGLEVBQUU7QUFFZ0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xccGNcXERvd25sb2Fkc1xcQ0dfUG9ydGFsLW1haW5cXENHX1BvcnRhbC1tYWluXFxzcmNcXHV0aWxzXFxsb2dnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQmFzaXQgYmlyIGxvZ2dlciBpbXBsZW1lbnRhc3lvbnVcbmNvbnN0IGxvZ2dlciA9IHtcbiAgaW5mbzogKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBjb25zb2xlLmxvZygnW0lORk9dJywgLi4uYXJncyk7XG4gICAgfVxuICB9LFxuICBlcnJvcjogKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbRVJST1JdJywgLi4uYXJncyk7XG4gICAgfVxuICB9LFxuICB3YXJuOiAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIGNvbnNvbGUud2FybignW1dBUk5dJywgLi4uYXJncyk7XG4gICAgfVxuICB9LFxuICBkZWJ1ZzogKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKCdbREVCVUddJywgLi4uYXJncyk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEhhdGEgbG9ndVxuICogXG4gKiBAcGFyYW0gbWVzc2FnZSAtIEhhdGEgbWVzYWrEsVxuICogQHBhcmFtIGVycm9yIC0gSGF0YSBuZXNuZXNpIHZleWEgZWsgYmlsZ2lcbiAqL1xuZXhwb3J0IGNvbnN0IGxvZ0Vycm9yID0gKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBhbnkpID0+IHtcbiAgbG9nZ2VyLmVycm9yKG1lc3NhZ2UsIGVycm9yKTtcbn07XG5cbi8qKlxuICogQmlsZ2kgbG9ndVxuICogXG4gKiBAcGFyYW0gbWVzc2FnZSAtIEJpbGdpIG1lc2FqxLFcbiAqIEBwYXJhbSBkYXRhIC0gRWsgdmVyaVxuICovXG5leHBvcnQgY29uc3QgbG9nSW5mbyA9IChtZXNzYWdlOiBzdHJpbmcsIGRhdGE/OiBhbnkpID0+IHtcbiAgbG9nZ2VyLmluZm8obWVzc2FnZSwgZGF0YSk7XG59O1xuXG4vKipcbiAqIFdlYmhvb2sgaXN0ZcSfaSBsb2d1XG4gKiBcbiAqIEBwYXJhbSBzb3VyY2UgLSBXZWJob29rIGtheW5hxJ/EsVxuICogQHBhcmFtIHN0YXR1cyAtIMSwxZ9sZW0gZHVydW11XG4gKiBAcGFyYW0gZGF0YSAtIMSwc3RlayB2ZXJpc2lcbiAqL1xuZXhwb3J0IGNvbnN0IGxvZ1dlYmhvb2sgPSAoc291cmNlOiBzdHJpbmcsIHN0YXR1czogJ3N1Y2Nlc3MnIHwgJ2Vycm9yJywgZGF0YT86IGFueSkgPT4ge1xuICBjb25zdCBtZXNzYWdlID0gYFdlYmhvb2sgYWzEsW5kxLE6ICR7c291cmNlfSAtIER1cnVtOiAke3N0YXR1c31gO1xuICBpZiAoc3RhdHVzID09PSAnZXJyb3InKSB7XG4gICAgbG9nZ2VyLmVycm9yKG1lc3NhZ2UsIGRhdGEpO1xuICB9IGVsc2Uge1xuICAgIGxvZ2dlci5pbmZvKG1lc3NhZ2UsIGRhdGEpO1xuICB9XG59O1xuXG5leHBvcnQgeyBsb2dnZXIgfTsgIl0sIm5hbWVzIjpbImxvZ2dlciIsImluZm8iLCJhcmdzIiwicHJvY2VzcyIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIndhcm4iLCJkZWJ1ZyIsImxvZ0Vycm9yIiwibWVzc2FnZSIsImxvZ0luZm8iLCJkYXRhIiwibG9nV2ViaG9vayIsInNvdXJjZSIsInN0YXR1cyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/logger.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = import("pg");;

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fadvisor%2Fstudents%2Froute&page=%2Fapi%2Fadvisor%2Fstudents%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadvisor%2Fstudents%2Froute.ts&appDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpc%5CDownloads%5CCG_Portal-main%5CCG_Portal-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();