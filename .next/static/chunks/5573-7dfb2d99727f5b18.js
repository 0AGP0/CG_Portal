"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5573],{1506:(e,t,a)=>{a.d(t,{DocumentProvider:()=>u,U:()=>l});var r=a(5155),i=a(2115);let s=[{id:"high_school_diploma",name:"Lise Diploması \xd6rneği",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"osym_placement",name:"\xd6SYM Yerleştirme Belgesi",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"passport",name:"Pasaport Fotokopisi",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"cv",name:"Detaylı \xd6zge\xe7miş",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"high_school_transcript",name:"Lise transkripti",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT"]},{id:"osym_result",name:"\xd6SYM Sonu\xe7 Belgesi",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT"]},{id:"university_transcript",name:"Lisans/\xd6n lisans Transkripti",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"university_diploma",name:"Lisans-\xd6n lisans Diploması/Mezuniyet Belgesi",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["UNIVERSITY_GRADUATE"]},{id:"student_certificate",name:"\xdcniversite \xd6ğrenci Belgesi",required:!0,status:"PENDING",stage:"PREPARATION",studentTypes:["UNIVERSITY_STUDENT"]}],n=[{id:"financial_proof",name:"Finansal kanıt belgesi",description:"\xd6demesi tamamlanmış olan bloke hesap onay belgesi ya da garant\xf6r belgesi",required:!0,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"blocked_account_receipt",name:"Bloke hesap dekontu",description:"Bloke hesap ile ilerlenecek olması halinde",required:!0,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"language_course_payment",name:"Almanya'daki dil kursu \xf6deme belgesi",description:"C1 kaydı dahil olmak \xfczere",required:!0,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"biometric_photo",name:"Biyometrik fotoğraf",required:!0,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"german_language_certificate",name:"Almanca dil sınav sonu\xe7 belgesi",description:"Minimum A1 başarılı sonu\xe7 belgesi, Goethe, Telc vb.",required:!0,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"insurance_documents",name:"Sigorta belgeleri",description:"AT 11 ve Care Concept",required:!0,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]},{id:"english_language_certificate",name:"TOEFL veya IELTS belgesi",description:"İngilizce b\xf6l\xfcm başvurularında aranmaktadır",required:!1,status:"PENDING",stage:"VISA_APPLICATION",studentTypes:["HIGH_SCHOOL_GRADUATE","UNIVERSITY_STUDENT","UNIVERSITY_GRADUATE"]}],o=(0,i.createContext)(void 0);function u(e){let{children:t}=e,[a,u]=(0,i.useState)([...s,...n]),[l,d]=(0,i.useState)("PREPARATION"),c=async(e,t)=>{u(a=>a.map(a=>a.id===e?{...a,status:"UPLOADED",uploadedAt:new Date,fileUrl:URL.createObjectURL(t)}:a))};return(0,r.jsx)(o.Provider,{value:{documents:a,uploadDocument:c,getDocumentsByStudentType:e=>a.filter(t=>t.studentTypes.includes(e)),getDocumentsByStage:e=>a.filter(t=>t.stage===e),getPendingDocuments:()=>a.filter(e=>"PENDING"===e.status&&e.stage===l),approveDocument:e=>{u(t=>t.map(t=>t.id===e?{...t,status:"APPROVED",reviewedAt:new Date}:t))},rejectDocument:e=>{u(t=>t.map(t=>t.id===e?{...t,status:"REJECTED",reviewedAt:new Date}:t))},currentStage:l,setCurrentStage:d},children:t})}function l(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useDocuments must be used within a DocumentProvider");return e}},5573:(e,t,a)=>{a.d(t,{E:()=>u,NotificationProvider:()=>l});var r=a(5155),i=a(2115),s=a(9576),n=a(1506);let o=(0,i.createContext)({notifications:[],dashboardNotifications:[],unreadCount:0,addNotification:()=>{},markAsRead:()=>{},markAllAsRead:()=>{},clearNotification:()=>{}}),u=()=>(0,i.useContext)(o),l=e=>{let{children:t}=e,[a,u]=(0,i.useState)([]),[l,d]=(0,i.useState)([]),{user:c}=(0,s.A)(),{documents:T,currentStage:A,getDocumentsByStage:I}=(0,n.U)(),E=a.filter(e=>!e.isRead).length,m=e=>{let t={...e,id:Date.now().toString(),timestamp:new Date,isRead:!1};u(e=>[t,...e]),d(a=>a.find(t=>t.type===e.type&&t.stage===e.stage)?a:[t,...a])};return(0,i.useEffect)(()=>{if(!c||"student"!==c.role)return;let e=I(A).filter(e=>"PENDING"===e.status);e.length>0&&(l.find(e=>"document_required"===e.type&&e.stage===A)||m({type:"document_required",title:"PREPARATION"===A?"Hazırlık Belgeleri":"Vize Belgeleri",message:"".concat("PREPARATION"===A?"Hazırlık":"Vize"," aşaması i\xe7in ").concat(e.length," belge y\xfcklemeniz gerekmektedir."),stage:A}))},[A,T,c]),(0,r.jsx)(o.Provider,{value:{notifications:a,dashboardNotifications:l,unreadCount:E,addNotification:m,markAsRead:e=>{u(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))},markAllAsRead:()=>{u(e=>e.map(e=>({...e,isRead:!0})))},clearNotification:e=>{u(t=>t.filter(t=>t.id!==e))}},children:t})}},9576:(e,t,a)=>{a.d(t,{A:()=>u,AuthProvider:()=>o});var r=a(5155),i=a(2115),s=a(9723);let n=(0,i.createContext)(void 0);function o(e){let{children:t}=e,[a,o]=(0,i.useState)(null),[u,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!0),[T,A]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{try{var e,t;c(!0);let a=null==(e=document.cookie.split("; ").find(e=>e.startsWith("user=")))?void 0:e.split("=")[1],r=null==(t=document.cookie.split("; ").find(e=>e.startsWith("token=")))?void 0:t.split("=")[1];if(a&&r)try{let e=decodeURIComponent(a),t=JSON.parse(e);if(s.vF.info("Cookie'den kullanıcı bilgileri y\xfcklendi:",t),t&&t.email&&t.role&&t.id){let e=await fetch("/api/auth/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({email:t.email,role:t.role}),credentials:"include"});if(e.ok)o(t),l(!0),s.vF.info("Kullanıcı oturumu doğrulandı:",t.email);else throw s.vF.error("Oturum doğrulama hatası:",await e.text()),Error("Oturum doğrulanamadı")}else throw s.vF.error("Ge\xe7ersiz kullanıcı bilgileri:",t),Error("Ge\xe7ersiz kullanıcı bilgileri")}catch(e){throw s.vF.error("Cookie parse hatası:",e),document.cookie="user=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",Error("Kullanıcı bilgileri okunamadı")}else s.vF.info("Kullanıcı cookie'si bulunamadı"),o(null),l(!1)}catch(e){s.vF.error("Oturum başlatma hatası:",e),document.cookie="user=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",o(null),l(!1)}finally{c(!1)}})()},[]);let I=async(e,t,a)=>{try{A(null);let r=a||"student",i="/api/auth/".concat(r);s.vF.info("Giriş isteği g\xf6nderiliyor:",{endpoint:i,email:e,role:r});let n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:t})});if(!n.ok){let e=await n.json().catch(()=>({error:"Sunucu hatası"}));throw Error(e.error||"Giriş başarısız")}let u=await n.json();if(!u.success||!u.user)throw Error(u.error||"Ge\xe7ersiz yanıt formatı");let d={...u.user,role:u.user.role||r};return document.cookie="token=".concat(u.token||"dummy-token","; path=/; max-age=86400; SameSite=Lax; Secure"),document.cookie="user=".concat(encodeURIComponent(JSON.stringify(d)),"; path=/; max-age=86400; SameSite=Lax; Secure"),o(d),l(!0),s.vF.info("Giriş başarılı:",d),!0}catch(e){return s.vF.error("Giriş hatası:",e),A(e instanceof Error?e.message:"Giriş yapılırken bir hata oluştu"),!1}},E=async()=>{try{document.cookie="token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="user=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",o(null),l(!1),A(null),window.location.href="/login"}catch(e){s.vF.error("\xc7ıkış hatası:",e),A("\xc7ıkış yapılırken bir hata oluştu")}},m=async()=>{if(a)try{let e=await fetch("/api/student/start-process",{method:"POST",headers:{"Content-Type":"application/json","x-user-email":a.email}});if(!e.ok)throw Error("S\xfcre\xe7 başlatılamadı");(await e.json()).success&&o(e=>e?{...e,processStarted:!0}:null)}catch(e){throw s.vF.error("S\xfcre\xe7 başlatma hatası:",e),e}},N=async()=>{if(a)try{let e=await fetch("/api/student/reset-process",{method:"POST",headers:{"Content-Type":"application/json","x-user-email":a.email}});if(!e.ok)throw Error("S\xfcre\xe7 sıfırlanamadı");(await e.json()).success&&o(e=>e?{...e,processStarted:!1}:null)}catch(e){throw s.vF.error("S\xfcre\xe7 sıfırlama hatası:",e),e}};return(0,r.jsx)(n.Provider,{value:{user:a,isAuthenticated:u,isLoading:d,error:T,login:I,logout:E,isAdvisor:()=>(null==a?void 0:a.role)==="advisor",isAdmin:()=>(null==a?void 0:a.role)==="admin",startProcess:m,resetProcess:N},children:t})}function u(){let e=(0,i.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9723:(e,t,a)=>{a.d(t,{vF:()=>r});let r={info:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},error:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},warn:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},debug:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]}}}}]);